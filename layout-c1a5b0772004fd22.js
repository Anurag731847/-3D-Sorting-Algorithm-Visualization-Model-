try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6729c08d-0cc4-47ee-a828-e2515867cbd8",e._sentryDebugIdIdentifier="sentry-dbid-6729c08d-0cc4-47ee-a828-e2515867cbd8")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8825],{49383:function(e,t,r){Promise.resolve().then(r.bind(r,6697))},94875:function(e,t,r){"use strict";r.d(t,{E:function(){return v}});var s=r(57437),n=r(5978),a=r(2265),l=r(27648),i=r(99376),o=r(46214),c=r(94508),d=r(89651);let u=function(e){let{defaultValue:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{defaultValue:!1},[r,s]=(0,d.Z)(e,{defaultValue:t});return[r,s]};var m=r(62869),h=r(57346),x=r(25566),p=e=>{let{type:t,message:r,persistDismiss:n=!1,storageKey:d,bgColor:p,href:f,onClick:v,className:j,darkCloseIcon:g=!1}=e,b=(0,i.usePathname)(),y=(0,a.useRef)(null),[w,N]=u(d||"default-banner-key",{defaultValue:!0}),[_,E]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1);(0,a.useEffect)(()=>{S(!0),E(!0)},[]);let k=(null==b?void 0:b.startsWith("/projects/"))&&["ph-launch-banner","rebrand-banner"].includes(d||""),P=!k&&(n?w:_);if(k)return null;if(n&&!d)return console.error("storageKey is required when persistDismiss is true"),null;if(!P||x.env.TEST_E2E)return null;let z=(0,s.jsxs)("div",{ref:y,className:(0,c.cn)("z-[1050] hidden w-full items-center justify-between px-2 py-2 text-white transition-opacity duration-300 md:px-4",p||("error"===t?"bg-red-800":"bg-background"),j,C&&"flex"),children:[(0,s.jsx)("div",{className:"flex flex-grow items-center justify-center space-x-4 pr-6 md:text-center",children:r}),(0,s.jsx)(m.z,{variant:"ghost",size:"icon",className:(0,c.cn)("hover:bg-transparent md:absolute md:right-2",g?"text-primary-foreground hover:text-primary-foreground":"text-primary"),onClick:e=>{e.stopPropagation(),n?N(!1):E(!1),o.ZP.capture("banner_dismissed",{banner_type:t,message:r,persisted:n})},children:(0,s.jsx)(h.Z,{name:"close_small"})})]});return f?(0,s.jsx)(l.default,{href:f,target:"_blank",rel:"noopener noreferrer",onClick:v,className:"transition-opacity hover:opacity-90",children:z}):z},f=r(78099);let v=e=>{let{className:t}=e,[r,l]=(0,a.useState)({showStatusBanner:!1,statusBannerContent:""});return((0,a.useEffect)(()=>{(async()=>{let e=(0,n.JU)(f.db,"system","info"),t=await (0,n.QT)(e);t.exists()&&l(t.data())})()},[]),r.showStatusBanner&&r.statusBannerContent)?(0,s.jsx)(p,{message:r.statusBannerContent,type:"error",className:t}):null}},9476:function(e,t,r){"use strict";r.d(t,{o:function(){return d}});var s=r(21770),n=r(43577),a=r(99376),l=r(14438),i=r(49340),o=r(36710),c=r(21288);let d=e=>{let[t]=(0,i.a)(),r=(0,o.O)(),d=(0,a.useRouter)(),{mutate:u,isPending:m}=(0,s.D)({mutationFn:async e=>{let{projectId:t,includeHistory:s}=e,{project_id:n}=await r.post("/projects/".concat(t,"/remix"),{include_history:s});return n},onMutate:()=>{var t;null==e||null===(t=e.onSubmit)||void 0===t||t.call(e)},onSuccess:e=>{(0,l.Am)("Project remixed",{description:"We're taking you to the new project page"}),d.push("/projects/".concat(e))},onError:(e,t)=>{let{projectId:r}=t;c.PW.error("Error remixing project",{projectId:r,error:e}),e.status===n.WE.Unauthorized?l.Am.error("You have to be logged in to remix projects"):l.Am.error("Error remixing project",{description:"Please try again"})}});return{mutate:u,isPending:m&&!!t}}},6697:function(e,t,r){"use strict";r.r(t),r.d(t,{ProjectEditLayout:function(){return rU},default:function(){return rM}});var s=r(57437),n=r(95098),a=r(99376),l=r(2265),i=r(44481),o=r(14438),c=r(28667),d=r(27648),u=r(46214),m=r(62869),h=r(57346),x=r(81103),p=r(51826),f=r(94508),v=e=>{let{openSidebar:t}=e,{tab:r="",project_id:n}=(0,a.useParams)(),l="history"===r;return(0,s.jsxs)(x.u,{children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)(m.z,{variant:"ghost",size:"icon-sm",className:(0,f.cn)("bg-transparent hover:bg-transparent md:hover:bg-accent/75",l&&"bg-accent hover:bg-accent md:hover:bg-accent/75"),asChild:!0,children:(0,s.jsx)(d.default,{href:n&&!l?"/projects/".concat(n,"/history"):"/projects/".concat(n),onClick:()=>{l||(u.ZP.capture(p.S.TABS.HISTORY_OPENED),t())},children:(0,s.jsx)(h.Z,{name:"history_2",size:"small"})})})}),(0,s.jsx)(x._v,{children:l?"Hide history":"View history"})]})},j=r(77933),g=r(32825),b=r(19125),y=r(27132),w=r(78099);let N=(0,l.memo)(e=>{let{isSidebarOpen:t,toggleSidebar:r}=e;return(0,s.jsxs)(x.u,{children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)(m.z,{size:"icon-sm",variant:"ghost",onClick:r,className:(0,f.cn)("hover:bg-muted-hover"),children:(0,s.jsx)(h.Z,{name:t?"dock_to_right-fill":"dock_to_right",size:"small"})})}),(0,s.jsx)(x._v,{children:t?"Hide sidebar":"View sidebar"})]})});N.displayName="SidebarToggle";var _=r(82246),E=r(94023),C=r(1188);let S=(0,l.createContext)(void 0);function k(e){let{children:t}=e,[r,n]=(0,l.useState)("preview"),a=(0,l.useMemo)(()=>({tab:r,setTab:n}),[r]);return(0,s.jsx)(S.Provider,{value:a,children:t})}function P(){let e=(0,l.useContext)(S);if(!e)throw Error("usePreview must be used within a PreviewProvider");return e}var z=r(63420),R=r(63611),I=r(23664),Z=r(32429);function D(){var e;let t=!!(null===(e=(0,Z.G)().features)||void 0===e?void 0:e.code_editor),r=(0,I.dl)("code_editor_write");return t||r}var T=()=>{let{tab:e,setTab:t}=P(),{hasUnsavedChanges:r}=(0,z.v)(),n=D()?"Dev mode":"Code viewer";return(0,s.jsxs)(x.u,{delayDuration:100,children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)("div",{className:"pointer-events-none flex h-full items-center justify-center",children:(0,s.jsx)(R.Z,{disabled:r,"aria-label":n,pressed:"code"===e,onPressedChange:e=>t(e?"code":"preview"),className:(0,f.cn)("duration-125 pointer-events-auto h-7 rounded-lg bg-muted p-px transition-colors ease-in-out","code"===e?"bg-affirmative hover:bg-affirmative/80":"hover:bg-muted-hover"),size:"sm",children:(0,s.jsx)("div",{className:"relative h-full w-10",children:(0,s.jsx)(C.E.div,{className:"absolute flex aspect-square h-full items-center justify-center rounded-lg bg-background text-foreground",animate:{right:"code"===e?0:"unset",left:"preview"===e?0:"unset"},transition:{duration:.15,bounce:0,type:"spring"},children:(0,s.jsx)(h.Z,{name:"code"})})})})})}),(0,s.jsx)(x._v,{children:r?"Please save or discard your changes":n})]})};let O=()=>(0,s.jsx)(T,{});var F=r(16593),A=r(44954),L=r(78735),M=r(55721),U=r(72253),J=r(62380),H=e=>{var t;let[r,n]=(0,l.useState)(!1),{openSettings:a}=(0,A.P7)(),i=(0,E.iZ)(e=>e.project),o=null==i?void 0:i.supabase_project_config,c=(0,U.S)(),d=(0,L.Z)(c,o),u=null===(t=c.supabaseOrganizations)||void 0===t?void 0:t.flatMap(e=>e.projects||[]),h=(null==o?void 0:o.supabase_project_id)&&!d,x=null==u?void 0:u.find(e=>e.id===(null==o?void 0:o.supabase_project_id));return h&&x?(0,s.jsxs)(M.h_,{open:r,onOpenChange:n,children:[(0,s.jsx)(M.$F,{children:(0,s.jsx)(W,{})}),(0,s.jsxs)(M.AW,{collisionPadding:8,children:[(0,s.jsx)(M.Ju,{className:"pb-0",children:x.name}),(0,s.jsx)(M.Ju,{children:(0,s.jsxs)("div",{className:"inline-flex min-h-8 w-auto items-center gap-2 rounded-md bg-muted-active px-3 py-0.5 text-sm font-medium text-primary",children:[(0,s.jsx)("div",{className:"size-2 shrink-0 rounded-full bg-green-500"}),(0,s.jsx)("span",{children:"Connected"})]})}),(0,s.jsx)(M.VD,{}),(0,s.jsx)(G,{href:"https://supabase.com/dashboard/project/".concat(x.id),label:"Dashboard"}),(0,s.jsx)(G,{href:"https://supabase.com/dashboard/project/".concat(x.id,"/auth/users"),label:"Manage Users"}),(0,s.jsx)(G,{href:"https://supabase.com/dashboard/project/".concat(x.id,"/editor"),label:"SQL Editor"}),(0,s.jsx)(G,{href:"https://supabase.com/dashboard/project/".concat(x.id,"/functions"),label:"Edge Functions"}),(0,s.jsx)(G,{href:"https://supabase.com/dashboard/project/".concat(x.id,"/settings/functions"),label:"Manage Secrets"}),(0,s.jsx)(M.VD,{}),(0,s.jsx)(M.Ju,{children:(0,s.jsx)(m.z,{onClick:()=>{a("supabase"),n(!1)},className:"w-full",children:"Manage Supabase"})})]})]}):(0,s.jsx)(W,{onClick:()=>a("supabase")})};let W=e=>{let{onClick:t}=e;return(0,s.jsxs)(m.z,{className:"",variant:"muted",size:"sm",onClick:t,children:[(0,s.jsx)(J.Z,{className:"h-4 w-auto",viewBox:"0 0 109 113"}),(0,s.jsx)("span",{className:"hidden md:flex",children:"Supabase"})]})},G=e=>{let{href:t,label:r}=e;return(0,s.jsx)(M.Xi,{asChild:!0,children:(0,s.jsxs)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"min-w-[200px] justify-between",children:[r,(0,s.jsx)(h.Z,{name:"arrow_outward",size:"small"})]})})};var B=r(33187),V=r(29827),q=r(21770),K=r(93022),Y=r(65666),$=r(49340),Q=r(36710),X=r(97318),ee=r(20984),et=r(13673);let er=e=>(t,r)=>t.id===e?-1:r.id===e?1:0,es=()=>{let[e]=(0,$.a)(),t=(0,Y.D)(),r=(0,V.NL)();(0,l.useEffect)(()=>()=>{r.refetchQueries({queryKey:X.iZ.collaborators(t)})},[r,t]);let n=(0,et.ZP)(e=>e.collaborators),a=(0,l.useMemo)(()=>Object.values(n).sort(er(null==e?void 0:e.uid)).filter(e=>e.access_level!==ee.u.NONE),[n,null==e?void 0:e.uid]),i=(0,et.ZP)(e=>e.collaboratorsInitialized);return(0,s.jsxs)("div",{className:"flex w-full flex-col gap-3",children:[(0,s.jsx)("h4",{className:"text-base font-semibold",children:"People with access"}),i?a.map(e=>(0,s.jsx)(en,{collaboratorId:e.id,displayName:e.display_name,email:e.email,username:e.username,accessLevel:e.access_level},e.id)):(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,s.jsx)(K.O,{className:"mb-1 mt-1 h-[1em] w-full"}),(0,s.jsx)(K.O,{className:"mb-4 h-[1em] w-3/4"})]})]})},en=e=>{let{collaboratorId:t,displayName:r,email:n,accessLevel:a,username:i}=e,[c]=(0,$.a)(),u=(0,Q.O)(),p=(0,Y.D)(),f=(0,V.NL)(),v=(0,q.D)({mutationFn:async e=>{await u.post("/projects/".concat(p,"/collaborators/").concat(e,"/deactivate"))},onSuccess:async()=>{o.Am.success("Collaborator removed successfully"),await f.refetchQueries({queryKey:X.iZ.collaborators(p)})},onError:()=>{o.Am.error("Failed to remove collaborator")}}),j=(0,l.useCallback)(()=>{v.mutate(t)},[v,t]);return(0,s.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col gap-1",children:[(0,s.jsxs)("div",{className:"flex min-w-0 gap-1 text-sm font-medium",children:[(0,s.jsx)(d.default,{href:"/@".concat(i),className:"truncate hover:underline",children:r}),a===ee.u.ADMIN&&(0,s.jsx)("span",{className:"whitespace-nowrap text-muted-foreground",children:"(owner)"}),(null==c?void 0:c.uid)===t&&(0,s.jsx)("span",{className:"whitespace-nowrap text-muted-foreground",children:"(you)"})]}),(0,s.jsx)("div",{className:"truncate text-xs text-muted-foreground",children:n})]}),a!==ee.u.ADMIN&&(0,s.jsx)(x.pn,{children:(0,s.jsxs)(x.u,{defaultOpen:!1,children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)(m.z,{disabled:v.isPending,onClick:j,variant:"ghost",size:"icon-sm",className:"ml-auto",children:(0,s.jsx)(h.Z,{name:"delete",size:"small",className:"text-muted-foreground"})})}),(0,s.jsx)(x._v,{children:(null==c?void 0:c.uid)===t?"Remove yourself from the project":"Remove collaborator"})]})})]})};var ea=r(6478),el=r(49131);let ei=(0,l.forwardRef)((e,t)=>(0,s.jsx)(m.z,{size:"icon-sm",ref:t,...e,variant:"ghost",children:(0,s.jsx)(h.Z,{name:"content_copy",size:"small"})}));ei.displayName="TriggerComponent";let eo=()=>{let e=(0,Q.O)(),t=(0,Y.D)(),{data:r,isLoading:n}=(0,F.a)({queryKey:X.iZ.secretLinkId(t),queryFn:async()=>{let r=await e.get("/projects/".concat(t,"/magic-codes"));return r.length>0&&r[0].id?r[0].id:null}});return(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,s.jsx)("h4",{className:"text-base font-semibold",children:"Secret Link"}),(0,s.jsx)("p",{className:"subtext text-sm text-muted-foreground",children:"Share your secret link for others to access."}),n?(0,s.jsx)(K.O,{className:"h-7 w-full"}):r?(0,s.jsx)(ec,{secretLinkId:r}):(0,s.jsx)(ed,{})]})},ec=e=>{let{secretLinkId:t}=e,r=(0,el.S)(),n=(0,Y.D)(),a=(0,V.NL)(),i=(0,ea.F)(),{mutate:c,isPending:d}=(0,q.D)({mutationFn:async()=>{await r.delete("/projects/".concat(n,"/magic-codes/").concat(t))},onSuccess:()=>{a.setQueryData(X.iZ.secretLinkId(n),null),(0,o.Am)("Secret link deactivated")},onError:()=>{o.Am.error("Failed to deactivate secret link")}}),u=(0,l.useCallback)(()=>{c()},[c]),p=(0,l.useMemo)(()=>t?"".concat(window.location.origin,"/projects/").concat(n,"?magic_link=").concat(t):null,[n,t]);return(0,s.jsxs)("div",{className:"nowrap flex items-center text-muted-foreground",children:[(0,s.jsx)("div",{className:"truncate text-xs",children:p}),(0,s.jsx)(x.pn,{children:(0,s.jsxs)(x.u,{defaultOpen:!1,children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)("div",{children:i({TriggerComponent:ei,textToCopy:null!=p?p:""})})}),(0,s.jsx)(x._v,{children:"Copy secret link"})]})}),(0,s.jsx)(x.pn,{children:(0,s.jsxs)(x.u,{defaultOpen:!1,children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)(m.z,{disabled:d,size:"icon-sm",onClick:u,variant:"ghost",children:(0,s.jsx)(h.Z,{name:"delete",size:"small"})})}),(0,s.jsx)(x._v,{children:"Deactivate secret link"})]})})]})},ed=()=>{let e=(0,Y.D)(),t=(0,V.NL)(),r=(0,el.S)(),{mutate:n,isPending:a}=(0,q.D)({mutationFn:async()=>r.post("/projects/".concat(e,"/magic-codes"),{access_level:"write"}),onSuccess:r=>{t.setQueryData(X.iZ.secretLinkId(e),r.id),(0,o.Am)("Secret link created")},onError:()=>{o.Am.error("Failed to create secret link")}}),i=(0,l.useCallback)(()=>{n()},[n]);return(0,s.jsxs)("button",{className:(0,f.cn)("flex h-7 items-center",a&&"opacity-50"),onClick:i,disabled:a,children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Create link"}),(0,s.jsx)(h.Z,{className:"ml-auto mr-1.5 text-muted-foreground",name:"add_link",size:"small"})]})},eu=()=>(0,s.jsxs)(M.h_,{children:[(0,s.jsxs)(x.u,{children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)(M.$F,{asChild:!0,children:(0,s.jsxs)(m.z,{variant:"muted",size:"sm",className:"flex-shrink-0 gap-1.5",children:[(0,s.jsx)(h.Z,{name:"group_add",size:"small"}),(0,s.jsx)("span",{className:"hidden md:flex",children:"Collaborate"})]})})}),(0,s.jsx)(x._v,{children:"Collaborate on your project with others"})]}),(0,s.jsxs)(M.AW,{className:"z-[1001] flex w-full max-w-[250px] flex-col gap-4 rounded-md border border-border bg-background p-4",collisionPadding:8,onCloseAutoFocus:e=>e.preventDefault(),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-2 flex w-full flex-1 items-center justify-between",children:(0,s.jsx)("h3",{className:"flex w-full items-center",children:"Collaborate"})}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Collaborators will use their own credits when editing your project."})]}),(0,s.jsx)(eo,{}),(0,s.jsx)(es,{})]})]});var em=r(21288),eh=r(74225),ex=r(26110);let ep=e=>{let{open:t,onOpenChange:r,errorMessage:n}=e;return(0,s.jsx)(ex.Vq,{open:t,onOpenChange:r,children:(0,s.jsxs)(ex.cZ,{className:"py-16 text-center",children:[(0,s.jsxs)(ex.fK,{children:[(0,s.jsx)(ex.$N,{className:"text-center text-2xl",children:"Oops! \uD83D\uDE22"}),(0,s.jsx)("p",{className:"text-center",children:"Something went wrong and we couldn't publish your site."}),n&&(0,s.jsxs)("div",{className:"mt-4 flex flex-col items-center",children:[(0,s.jsx)("p",{className:"text-center",children:"The build failed with the following message:"}),(0,s.jsx)("p",{className:"mx-auto mt-2 max-w-[80%] text-center font-medium text-destructive",children:n})]})]}),(0,s.jsx)(m.z,{variant:"default",onClick:()=>r(!1),children:"Close"})]})})};var ef=r(1206),ev=e=>{let{customDomains:t}=e,r=(0,I.dl)("custom_domains")||!1,[n,a]=(0,l.useState)(!1),[i,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(),p=(0,E.iZ)(e=>e.project),f=null==p?void 0:p.id,v=(0,Q.O)(),j=(0,q.D)({mutationFn:()=>v.post("/projects/".concat(f,"/deployments"),{}),onSuccess:()=>{o.Am.success("Project updated!",{description:"Published project updated"})},onError:e=>{if(422===e.status){var t;u((null===(t=e.data)||void 0===t?void 0:t.detail)||null)}c(!0)}}),g=async()=>{if(!f){em.PW.error("project id is missing, can't deploy");return}j.mutate()},{openSettings:b}=(0,A.P7)(),y=t&&t.length>0;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(M.h_,{onOpenChange:a,open:n,children:[(0,s.jsxs)(x.u,{children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)(M.$F,{asChild:!0,children:(0,s.jsxs)(m.z,{variant:"muted",size:"sm",className:"gap-1.5",children:[(0,s.jsx)(h.Z,{name:"language",className:"text-muted-foreground"}),(0,s.jsx)("span",{className:"hidden md:flex",children:"Publish"})]})})}),(0,s.jsx)(x._v,{children:"Visibility and Publish"})]}),(0,s.jsxs)(M.AW,{className:"z-[1001] min-w-[275px] max-w-[350px] rounded-md border border-border bg-background p-4",align:"end",collisionPadding:8,onCloseAutoFocus:e=>e.preventDefault(),children:[(0,s.jsxs)("div",{className:"flex flex-col text-muted-foreground",children:[(0,s.jsxs)("p",{children:[(null==p?void 0:p.url)?"Update":"Publish"," your project:"]}),(0,s.jsxs)("ul",{className:"text-xs",children:[(null==p?void 0:p.url)?(0,s.jsxs)("li",{className:"mt-2 flex items-center",children:[(0,s.jsxs)("span",{className:"flex-grow",children:[(0,s.jsx)(h.Z,{name:"language",className:"mr-1 inline w-4 text-muted-foreground"}),(0,eh.P)(p.url)]}),(0,s.jsx)("a",{href:null==p?void 0:p.url,target:"_blank",children:(0,s.jsx)(h.Z,{name:"arrow_outward",size:"small"})})]}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("li",{className:"mt-2 flex items-center",children:[(0,s.jsxs)("span",{className:"flex flex-grow",children:[(0,s.jsx)(h.Z,{name:"language",className:"mr-1 inline w-4 text-muted-foreground"}),(0,s.jsxs)("p",{className:"inline-block",children:[null==p?void 0:p.name,".lovable.app",(0,s.jsx)("br",{}),(0,s.jsx)("span",{className:"italic",children:"Not published"})]})]}),(0,s.jsx)("br",{})]})}),null==t?void 0:t.map((e,t)=>(0,s.jsx)(ef.Z,{domain:e,showRemove:!1,showIcon:!0},t))]})]}),(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsx)(m.z,{size:"sm",onClick:g,loading:j.isPending,variant:"accent",children:(null==p?void 0:p.url)?"Update":"Publish"}),r&&(0,s.jsx)(m.z,{size:"sm",onClick:()=>{b("domains")},variant:"secondary",children:y?"Manage domains":"Connect custom domain"})]})]})]}),(0,s.jsx)(ep,{open:i,onOpenChange:c,errorMessage:d})]})},ej=r(30068);let eg=(0,l.memo)(function(e){let{projectId:t}=e,r=(0,I.dl)("collaboration")||!1,n=(0,_.Eh)(e=>e.userProjectPermissions),{data:a,refetch:l}=(0,F.a)(B.W.domains({projectId:t}));return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(H,{}),r&&n.admin&&(0,s.jsx)(eu,{}),n.admin&&(0,s.jsx)(ej.Z,{}),(0,s.jsx)(ev,{customDomains:null!=a?a:[],refetchDomains:l})]})});var eb=r(35974);let ey=(0,l.memo)(function(e){let{editNumber:t,commitMessage:r}=e;return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Previewing"}),(0,s.jsx)(eb.C,{variant:"outline",className:"inline-flex gap-1 text-xs",children:(0,s.jsx)("p",{children:r})})]})});var ew=r(52552),eN=r(81004);let e_=(0,l.memo)(function(e){let{activeEdit:t}=e;return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(ew.k,{}),(0,s.jsx)(eN.q,{activeEdit:t})]})}),eE=(0,l.memo)(function(e){let{projectName:t,createdBy:r}=e;return(0,s.jsxs)("div",{className:"flex h-full items-center truncate",children:[(0,s.jsx)("strong",{children:t}),"\xa0by\xa0",(0,s.jsx)(d.default,{href:"/@".concat(r),children:(0,s.jsx)("strong",{children:r})})]})}),eC=(0,l.memo)(function(){let e=(0,_.Eh)(e=>e.setIsRemixDialogOpen),t=(0,_.Eh)(e=>e.userProjectPermissions),r=(0,E.iZ)(e=>e.project),n=!!(null==r?void 0:r.is_supabase_enabled)||!!(null==r?void 0:r.supabase_project_config),a=t.edit||!n,i=(0,l.useCallback)(()=>{e(!0)},[e]);return(0,s.jsxs)(m.z,{className:"flex items-center gap-1",onClick:i,disabled:!a,children:[(0,s.jsx)(h.Z,{name:"shuffle",size:"small"}),"Remix"]})}),eS=()=>{let e=(0,_.Eh)(e=>e.userProjectPermissions),t=(0,E.iZ)(e=>e.project),r=(0,_.Eh)(e=>e.consoleContentType),n=(0,_.Eh)(e=>e.activeEdit);return(0,l.useMemo)(()=>t?n&&"preview"===r?{center:(0,s.jsx)(ey,{editNumber:n.number,commitMessage:n.commit_message}),right:(0,s.jsx)(e_,{activeEdit:n}),left:null}:e.edit?{center:null,right:(0,s.jsx)(eg,{projectId:t.id}),left:(0,s.jsx)(O,{})}:{center:(0,s.jsx)(eE,{projectName:t.name,createdBy:t.created_by}),right:(0,s.jsx)(eC,{}),left:null}:{center:null,right:null,left:null},[t,r,n,e])},ek=(0,l.memo)(e=>{let{isSidebarOpen:t,toggleSidebar:r,openSidebar:n,hideButtons:o}=e,d=(0,a.useRouter)(),[u,m]=(0,c.QJ)(w.I),h=(0,l.useCallback)(()=>{d.push("/settings")},[d]);(0,i.y1)("ctrl+shift+,; meta+shift+,",h,{splitKey:";"});let{left:x,center:p,right:f}=eS(),_=(0,g.usePanelStore)(e=>e.panelSizes)[0],E=(0,y.Z)("md"),C=(0,g.useMinPanelSize)();return(0,s.jsx)("nav",{className:"flex h-12 w-full shrink-0 items-center px-4",children:(0,s.jsx)(b.Z,{className:"flex w-full shrink-0 items-center",children:(0,s.jsxs)("div",{className:"flex w-full flex-shrink-0 items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-basis-0 flex-grow-1 flex flex-shrink-0 items-center gap-2",style:{width:E?"auto":0===_?"".concat(C,"%"):"".concat(_||g.DEFAULT_SIDEBAR_SIZE,"%")},children:[(0,s.jsx)(j.Z,{}),!o&&(0,s.jsxs)("div",{className:"flex flex-row-reverse gap-2 sm:ml-auto sm:mr-4 md:flex-row",children:[(0,s.jsx)(v,{openSidebar:n}),(0,s.jsx)(N,{isSidebarOpen:t,toggleSidebar:r})]})]}),(0,s.jsxs)("div",{className:"flex flex-grow justify-between gap-1 pl-2 md:pl-1",children:[(0,s.jsx)("div",{className:"",children:x}),(0,s.jsx)("div",{className:"",children:p}),(0,s.jsx)("div",{className:"",children:f})]})]})})})});ek.displayName="EditorNav";var eP=()=>{let e=(0,E.iZ)(e=>e.project),t=(0,_.Eh)(e=>e.isSendChatMessageMutationPending),r=null==e?void 0:e.available_project_migrations;return(0,l.useMemo)(()=>null!=r&&!!r.length&&r.length>0&&!t,[r,t])},ez=r(72384),eR=r(44831),eI=r(32935);let eZ=()=>{let e=(0,E.iZ)(e=>e.project),t=(0,Y.D)(),r=(0,_.Eh)(e=>e.isSendChatMessageMutationPending),n=(0,_.Eh)(e=>e.shouldBlockActions()),a=null==e?void 0:e.available_project_migrations,[i,c]=(0,l.useState)(!(null==a?void 0:a.length));(0,l.useEffect)(()=>{(null==a?void 0:a.length)||c(!1),(null==a?void 0:a.length)&&!r&&c(!0)},[null==a?void 0:a.length,r]);let{mutateAsync:d,isPending:u}=(0,eR.m)({projectId:t,onSuccess:async()=>{o.Am.success("Project Updated")},onSubmit:()=>{}}),h=async()=>{try{var r;await d({body:{id:(0,eI.dX)(),message:"Please update the project template to the latest Lovable version to enable new features.",mode:ez.S.INSTANT,contains_error:!1,project_migration_ids:null==e?void 0:null===(r=e.available_project_migrations)||void 0===r?void 0:r.map(e=>e.id)},projectId:t})}catch(e){em.PW.error(e),o.Am.error("Error",{description:"There was an error sending the project update request."})}};return e&&i?(0,s.jsxs)(ex.cZ,{children:[(0,s.jsx)(ex.fK,{children:(0,s.jsx)(ex.$N,{className:"text-xl font-semibold",children:"Project out of date"})}),(0,s.jsxs)(ex.Be,{className:"max-h-[80vh] overflow-y-auto scrollbar-thin scrollbar-track-transparent scrollbar-thumb-[#636575]",children:[a&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Available Updates"}),(0,s.jsx)("ul",{className:"space-y-3",children:a.map((e,t)=>(0,s.jsxs)("li",{className:"border-l-2 border-primary/20 pl-4",children:[(0,s.jsx)("h4",{className:"font-medium",children:e.name}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:e.description})]},t))})]}),(0,s.jsx)("p",{className:"mt-4 text-sm first-of-type:mt-0",children:"The AI assistant will guide you through the necessary steps to complete the migration."})]}),(0,s.jsxs)(ex.cN,{children:[(0,s.jsx)(ex.GG,{asChild:!0,children:(0,s.jsx)(m.z,{variant:"outline",children:"Close"})}),(0,s.jsx)(m.z,{disabled:n,loading:u,onClick:h,children:"Update Project"})]})]}):null};var eD=r(20958),eT=r(94875),eO=r(23374);let eF=e=>{let{className:t,...r}=e;return(0,s.jsx)(eO.eh,{className:(0,f.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...r})},eA=eO.s_,eL=e=>{let{tooltip:t,className:r,...n}=e,[a,i]=(0,l.useState)(!1),[o,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(0),[m,h]=(0,l.useState)(0);return(0,l.useEffect)(()=>{var e;let t;let r=(e=e=>{u(e.clientY)},function(){for(var r=arguments.length,s=Array(r),n=0;n<r;n++)s[n]=arguments[n];clearTimeout(t),t=setTimeout(()=>e.apply(this,s),100)});return window.addEventListener("mousemove",r),()=>{window.removeEventListener("mousemove",r)}},[]),(0,s.jsx)(eO.OT,{className:(0,f.cn)("relative -mr-px mb-[20px] mt-[12px] flex w-[2px] cursor-col-resize items-center justify-center rounded-full transition-colors duration-300 ease-in-out after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 hover:bg-accent focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 [&[data-panel-group-direction=vertical]>div]:rotate-90",r,a?"bg-accent":""),onDragging:e=>{i(e)},...n,children:t&&(0,s.jsx)(x.pn,{delayDuration:600,skipDelayDuration:0,children:(0,s.jsxs)(x.u,{disableHoverableContent:!0,open:!a&&o,onOpenChange:e=>{c(e),e&&h(d)},children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)("div",{className:"absolute -left-[2px] -right-[2px] bottom-0 top-0 z-[12000]"})}),(0,s.jsx)(x._v,{side:"right",align:"start",alignOffset:m>0?m-68:0,children:t})]})})})};var eM=r(85238),eU=r(5978);let eJ=()=>{let e=(0,Y.v)(),[t,r]=(0,$.a)(),s=null==t?void 0:t.uid,n=(0,_.Eh)(e=>e.setIsProjectCollaborator),a=(0,_.Eh)(e=>e.hasHandledCollaborationInvite);(0,l.useEffect)(()=>{if(!e||!s||r||!a)return;let t=(0,eU.JU)(w.db,"projects/".concat(e,"/collaborators/").concat(s));return(0,eU.cf)(t,e=>{let t=e.data();t&&t.access_level!=ee.u.NONE?n(t.access_level):n(null)},e=>{em.PW.error("PROJECT COLLABORATORS ERROR",{error:e})})},[e,r,s,n,a])};var eH=r(2043),eW=r(76906),eG=r(34495),eB=r(39674);let eV=(0,l.memo)(()=>{let e=(0,et.ZP)(e=>e.selectedImageUrl),t=(0,et.ZP)(e=>e.setSelectedImageUrl),r=(0,l.useCallback)(()=>{t(void 0)},[t]),n=(0,l.useCallback)(e=>{e.target===e.currentTarget&&r()},[r]),a=(0,l.useRef)(null);return(0,s.jsx)(ex.Vq,{open:void 0!==e,onOpenChange:r,children:(0,s.jsx)(ex.cZ,{className:"flex h-screen max-h-[100vh] w-screen max-w-[100vw] items-center justify-center border-none",onClick:n,children:(0,s.jsx)("div",{className:"relative inline-block max-h-[85vh] max-w-[90vw]",ref:a,children:(0,s.jsx)("img",{onLoad:e=>{let t=e.target;t&&a.current&&(a.current.style.aspectRatio="".concat(t.naturalWidth," / ").concat(t.naturalHeight))},className:"h-full w-full object-contain",src:e,alt:"Fullscreen Image"})})})})});eV.displayName="ImagePreviewDialogV2";let eq="magic_link",eK="collaborationInvite",eY=()=>{let e=localStorage.getItem(eK);return e?JSON.parse(e):null},e$=()=>{let[e,t]=(0,l.useState)(null),[r,s]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{t(eY()),s(!1)},[t]),{collaborationInvite:e,loading:r}},eQ=()=>{let e=(0,Y.v)(),t=(0,a.useSearchParams)().get(eq);return((0,l.useEffect)(()=>{null!=t&&null!=e&&localStorage.setItem(eK,JSON.stringify({projectId:e,token:t}))},[e,t]),t)?{projectId:e,token:t}:null},eX=()=>{let e=(0,Y.v)(),[t,r]=(0,l.useState)(!0),[s,n]=(0,l.useState)(null),a=eQ(),{collaborationInvite:i,loading:o}=e$();return(0,l.useEffect)(()=>{if(!s){if((null==a?void 0:a.projectId)===e){n(a.token),r(!1);return}o||((null==i?void 0:i.projectId)===e&&n(i.token),r(!1))}},[s,a,i,e,o]),{collaborationInviteToken:s,loading:t}},e0=()=>{let e=(0,Y.v)();(0,el.S)();let[t,r]=(0,$.a)(),s=(0,a.useRouter)(),n=(0,a.useSearchParams)(),[i,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(!1),{collaborationInviteToken:m,loading:h}=eX(),x=(0,_.Eh)(e=>e.isProjectCollaborator),p=(0,_.Eh)(e=>e.setHasHandledCollaboratorInvite),f=(0,l.useCallback)(async t=>{try{c(!0);let r=(0,el.S)();await r.post("/projects/".concat(e,"/magic-codes/").concat(t,"/join")),o.Am.success("Success",{description:"You are now a collaborator of this project"})}catch(e){}finally{localStorage.removeItem(eK);let e=new URLSearchParams(n.toString());e.delete(eq),s.replace("".concat(window.location.pathname,"?").concat(e.toString())),u(!0)}},[e,s,n,c]),v=!!(m&&!r&&!t),j=x||d||!(r||h)&&!v&&(!t||!m);return(0,l.useEffect)(()=>{!x&&t&&m&&!i&&f(m)},[t,x,f,m,i]),(0,l.useEffect)(()=>{v&&((0,o.Am)("Log in",{description:"You have to log in to join this project"}),s.push("/login?redirect=".concat(window.location.pathname)))},[s,v]),(0,l.useEffect)(()=>{j&&p(!0)},[j,p]),j};var e1=r(88746);let e2=e=>(0,s.jsx)(ex.Vq,{...e,children:(0,s.jsx)(ex.cZ,{className:"py-16 text-center",children:(0,s.jsxs)(ex.fK,{children:[(0,s.jsx)(ex.$N,{className:"text-center text-2xl",children:"This project has been deprecated."}),(0,s.jsx)("p",{className:"text-center",children:"This project is no longer supported, as it's using Gitlab. Please consider migrating the code to a new GitHub project."})]})})});var e4=r(48614);let e5=()=>{let[e,t]=(0,l.useState)(!1);return{GithubRequiredDialog:()=>(0,s.jsx)(ex.Vq,{open:e,onOpenChange:t,children:(0,s.jsx)(ex.cZ,{className:"sm:max-w-[425px]",children:(0,s.jsxs)(ex.fK,{children:[(0,s.jsx)(ex.$N,{children:"GitHub Access Required"}),(0,s.jsx)(ex.Be,{children:"This action requires GitHub access. Please connect your GitHub account under the GitHub button in the top-right."})]})})}),isOpen:e,open:()=>t(!0),close:()=>t(!1)}};var e6=r(4310),e3=r(99478),e7=r(27410),e9=r(20141);let e8=e=>{let{projectId:t,limit:r,reverted:s,constraints:n,disable:a}=e,i=(0,l.useMemo)(()=>{if(!t)return null;let e=[];return void 0!==r&&e.push((0,eU.b9)(r)),void 0!==s&&e.push((0,eU.ar)("reverted","==",s)),(0,eU.IO)((0,eU.hJ)(w.db,"projects",t,"edits"),...e,...n||[],(0,eU.Xo)("created_at","asc"))},[r,t,s,n]),[o,c,d]=(0,e9.d4)(i);return(0,l.useMemo)(()=>a||!i?{edits:[],isLoading:!1,isInitiated:!!o}:{edits:(o||[]).map((e,t)=>({...e,number:t+1})),isLoading:c,isInitiated:!!o},[a,c,i,o])};var te=r(30166),tt=r(90432),tr=r(91576),ts=r(31406),tn=r(50835),ta=r(23260),tl=r(51904),ti=r(73521),to=r(85755),tc=r(93252);let td=(0,r(67457).P0)({settings:{background:"hsl(var(--background))",gutterBackground:"hsl(var(--muted))",fontFamily:"var(--font-roboto-mono)",selection:"#2d333b",caret:"#c9d1d9",foreground:"#c9d1d9",gutterActiveForeground:"#c9d1d9",gutterForeground:"#6e7681",gutterBorder:"#21262d",lineHighlight:"#c9d1d910",selectionMatch:"#3392FF44"},styles:[{tag:tc.pJ.comment,color:"#8b949e"},{tag:tc.pJ.variableName,color:"#c9d1d9"},{tag:[tc.pJ.string,tc.pJ.special(tc.pJ.brace)],color:"#a5d6ff"},{tag:tc.pJ.number,color:"#79c0ff"},{tag:tc.pJ.bool,color:"#ff7b72"},{tag:tc.pJ.null,color:"#ff7b72"},{tag:tc.pJ.keyword,color:"oklch(0.833 0.145 321.434)"},{tag:tc.pJ.operator,color:"#ff7b72"},{tag:tc.pJ.className,color:"#ffa657"},{tag:tc.pJ.definition(tc.pJ.typeName),color:"#ffa657"},{tag:tc.pJ.typeName,color:"#ffa657"},{tag:tc.pJ.angleBracket,color:"#7ee787"},{tag:tc.pJ.tagName,color:"#7ee787"},{tag:tc.pJ.attributeName,color:"#79c0ff"},{tag:tc.pJ.function(tc.pJ.variableName),color:"#d2a8ff"},{tag:tc.pJ.function(tc.pJ.propertyName),color:"#d2a8ff"},{tag:tc.pJ.squareBracket,color:"#c9d1d9"},{tag:tc.pJ.brace,color:"#c9d1d9"}]}),tu=[(0,to.eJ)({jsx:!0,typescript:!0}),(0,ti.dy)({autoCloseTags:!0})];var tm=r(15345),th=r.n(tm),tx=r(55214),tp=r.n(tx);let tf={add_dependency:{icon:"deployed_code",color:"text-green-500"},remove_dependency:{icon:"deployed_code",color:"text-red-500"},delete:{icon:"scan_delete",color:"text-red-500"},delete_directory:{icon:"scan_delete",color:"text-red-500"},edit:{icon:"note_stack",color:"text-yellow-500"},new:{icon:"note_add",color:"text-green-500"},rename:{icon:"swap_horiz",color:"text-blue-500"},rename_directory:{icon:"swap_horiz",color:"text-blue-500"}},tv=["delete","delete_directory","add_dependency","remove_dependency","rename","rename_directory"],tj=e=>{let{filePath:t,oldFilePath:r,operation:n,className:a}=e;return(0,s.jsxs)("div",{className:(0,f.cn)("flex flex-row items-center gap-2 rounded-t-lg bg-transparent font-mono",a,{"rounded-b-lg":tv.includes(n)}),children:[(0,s.jsx)(h.Z,{name:tf[n].icon,className:tf[n].color,size:"small"}),r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:r}),(0,s.jsx)(h.Z,{name:"arrow_right",className:"text-muted-foreground",size:"small"})]}),(0,s.jsx)("span",{children:t})]})},tg=e=>{let{className:t,...r}=e;return(0,s.jsx)(tj,{...r,className:(0,f.cn)("border border-border px-3 py-2 text-sm font-medium",t)})},tb=[ta.Z],ty={code(e){let{node:t,className:r,children:n}=e;return/language-(\w+)/.exec(r||"")?(0,s.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,s.jsx)(ts.ZP,{readOnly:!0,value:String(n).replace(/\n$/,""),className:(0,f.cn)("flex-1 overflow-y-auto",th().editor),theme:td,extensions:tu})}):(0,s.jsx)("span",{className:"rounded bg-muted px-1.5 py-0.5 font-mono text-sm",children:n})}},tw=(0,l.memo)(e=>{let{part:t}=e;switch(t.type){case"writing_file":return(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)(tg,{filePath:t.file_path,operation:"new"}),(0,s.jsx)("div",{className:"overflow-hidden rounded-b-lg border-x border-b",children:(0,s.jsx)(ts.ZP,{readOnly:!0,value:t.content,className:(0,f.cn)("flex-1 overflow-y-auto",th().editor),theme:td,basicSetup:{foldGutter:!1,foldKeymap:!1},extensions:tu})})]});case"text":return(0,s.jsx)("div",{className:"prose prose-zinc prose-markdown mb-2 max-w-full dark:prose-invert ".concat(tp().customProse," prose-h1:mb-2 prose-h1:text-xl prose-h1:font-bold prose-h2:text-lg prose-h2:font-bold prose-h3:text-base prose-h3:font-bold prose-pre:my-2 prose-ol:my-2 prose-ul:my-2 prose-li:my-0"),children:(0,s.jsx)(tn.UG,{remarkPlugins:tb,components:ty,children:t.content})});case"edit":return(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)(tg,{filePath:t.file_path,operation:"edit"}),(0,s.jsx)("div",{className:"rounded-b-lg border-x border-b",children:t.search_replace_parts.map((e,t)=>(0,s.jsxs)("div",{className:"mb-1 p-2",children:[(0,s.jsxs)("div",{className:"mb-1 flex text-sm text-muted",children:[(0,s.jsx)("span",{className:"flex-1",children:"Search"}),(0,s.jsx)("span",{className:"flex-1",children:"Replace"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(ts.ZP,{readOnly:!0,value:e.search,className:(0,f.cn)("flex-1 overflow-y-auto",th().editor),theme:td,extensions:tu}),(0,s.jsx)(ts.ZP,{readOnly:!0,value:e.replace,className:(0,f.cn)("flex-1 overflow-y-auto",th().editor),theme:td,extensions:tu})]})]},t))})]});case"delete":return(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)(tg,{filePath:t.file_path,operation:"delete"})});case"rename":return(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(tg,{filePath:t.new_file_path,oldFilePath:t.original_file_path,operation:"rename"})});case"add_dependency":return(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)(tg,{filePath:t.dependency,operation:"add_dependency",className:"rounded-lg"})});case"remove_dependency":return(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)(tg,{filePath:t.removed_dependency,operation:"remove_dependency",className:"rounded-lg"})});case"error":return(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsxs)("div",{className:"flex items-center rounded-lg border border-warning p-3 text-sm font-medium",children:[(0,s.jsx)(h.Z,{name:"warning",className:"mr-2 text-warning",size:"small"}),(0,s.jsx)("span",{children:t.error_message})]})});case"tool_use":return(0,s.jsx)(tl.Q6,{name:t.name,parsedData:t.parsedData,done:t.done});default:return null}},(e,t)=>{let r=e.part,s=t.part;if(r.type!==s.type)return!1;switch(r.type){case"text":return r.content===s.content;case"writing_file":return r.file_path===s.file_path&&r.content===s.content;case"edit":if(r.search_replace_parts.length!==s.search_replace_parts.length)return!1;return r.file_path===s.file_path&&r.search_replace_parts.every((e,t)=>{let r=s.search_replace_parts[t];return e.search===r.search&&e.replace===r.replace});case"delete":return r.file_path===s.file_path;case"rename":return r.original_file_path===s.original_file_path&&r.new_file_path===s.new_file_path;case"add_dependency":return r.dependency===s.dependency&&r.isDevDependency===s.isDevDependency;case"remove_dependency":return r.removed_dependency===s.removed_dependency;case"error":return r.error_message===s.error_message;case"tool_use":return r.name===s.name&&r.data===s.data;default:return!1}});var tN=r(96139),t_=r(22135),tE=e=>{let{oldContent:t,newContent:r,filePath:n,originalFilePath:a,action:i,unified:o=!1}=e,[c,d]=(0,l.useState)(!0);return(0,s.jsxs)("div",{className:"overflow-hidden rounded-lg border border-border",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(tg,{filePath:n,className:"border-none",oldFilePath:a,operation:i}),(0,s.jsx)(m.z,{variant:"ghost",size:"icon-sm",onClick:()=>d(e=>!e),className:"mr-1",children:(0,s.jsx)(t_.Z,{className:(0,f.cn)("size-4 transition-transform duration-200",c?"":"rotate-180")})})]}),r&&(0,s.jsx)(C.E.div,{initial:{height:0},animate:{height:c?"auto":0},exit:{height:0},transition:{duration:.25},children:(0,s.jsx)(ts.ZP,{className:(0,f.cn)(th().editor,"border-t"),readOnly:!0,theme:td,extensions:[...tu,ts.tk.editable.of(!1),(0,tN.Z)({original:t,mergeControls:!1})],value:r})})]},n)};function tC(){return(0,s.jsx)("div",{className:"flex flex-col rounded-lg border border-border",children:(0,s.jsx)("div",{className:"flex items-center justify-between p-3",children:(0,s.jsx)("div",{className:"h-3 w-80 animate-pulse rounded bg-muted"})})})}let tS=l.memo(e=>{var t,r;let{activeEdit:n}=e,[a,i]=(0,l.useState)(Math.min(2,(null==n?void 0:null===(t=n.diff)||void 0===t?void 0:t.length)||0)),o=(0,l.useRef)(null);return(0,l.useEffect)(()=>()=>{null!==o.current&&clearTimeout(o.current)},[]),(0,l.useEffect)(()=>{(null==n?void 0:n.diff)&&a<n.diff.length&&(o.current=window.setTimeout(()=>{i(e=>{var t;return Math.min(e+2,(null===(t=n.diff)||void 0===t?void 0:t.length)||0)})},50))},[a,null==n?void 0:n.diff]),(0,s.jsx)("div",{className:"flex flex-col gap-4",children:null==n?void 0:null===(r=n.diff)||void 0===r?void 0:r.map((e,t)=>(0,s.jsx)(l.Fragment,{children:t<a?(0,s.jsx)(tE,{oldContent:e.old_content,newContent:e.new_content,filePath:e.file_path,originalFilePath:e.original_file_path,action:e.action}):(0,s.jsx)(tC,{})},"".concat(e.action,"-").concat(e.file_path,"-").concat(t)))})});tS.displayName="DiffView";var tk=r(61062);let tP=e=>{var t,r,n;let{errors:a,allErrors:l}=e,i=a.find(e=>{var t;return null===(t=e.meta_data)||void 0===t?void 0:t.url}),o=null==i?void 0:null===(t=i.meta_data)||void 0===t?void 0:t.url,c=null==i?void 0:null===(r=i.meta_data)||void 0===r?void 0:r.method,d=null==i?void 0:null===(n=i.meta_data)||void 0===n?void 0:n.origin,u=a.length===l.length?"This":"At least one of these";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"text-sm",children:[u," is a Cross-Origin Resource Sharing (CORS) error. It means that the HTTP call you made is not allowed by the server. This could be because the server is not configured to accept requests from the client URL. Unfortuantely this is not something that the AI can fix for you since we don't control the server you're trying to communicate with."]}),(0,s.jsx)("p",{className:"text-sm",children:"If you are in control of the server, please configure the server to accept requests from the client URL. If you are not in control of the server, please contact the server administrator to configure the server to accept requests from the client URL. If it's not possible to change the CORS configuration, explore other API services that do allow requests directly from the browser."}),(0,s.jsx)("table",{className:"text-sm",children:(0,s.jsxs)("tbody",{children:[o&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"font-bold",children:"URL"}),(0,s.jsx)("td",{children:o})]}),c&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"font-bold",children:"Method"}),(0,s.jsx)("td",{children:c})]}),d&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"font-bold",children:"Origin"}),(0,s.jsx)("td",{children:d})]})]})})]})};var tz=r(42503),tR=r(5707);function tI(e){let{onClick:t,label:r,disabled:n,icon:a}=e;return(0,s.jsx)(e7.Z,{label:r,children:(0,s.jsx)(m.z,{disabled:n,onClick:t,variant:"ghost",size:"sm",children:a&&(0,s.jsx)(h.Z,{name:a,size:"small"})})})}let tZ=e=>"string"==typeof e?e:(0,tz.l)((0,tR.K)(e.seconds),new Date),tD=e=>{switch(e){case tk.N.CORS_ERROR:return"CORS error";case tk.N.HTTP_SERVER_ERROR:return"HTTP server error";case tk.N.HTTP_CLIENT_ERROR:return"HTTP client error";case tk.N.SUPABASE_EDGE_FUNCTION_ERROR:return"Supabase edge function error";case tk.N.BUILD:return"Build error";case tk.N.RUNTIME:case tk.N.IMMEDIATE_RUNTIME:return"Runtime error";default:return"Error"}};function tT(e){let{errorId:t,hideFn:r}=e,n=(0,Y.v)(),a=(0,Q.O)(),{mutate:l,isPending:i}=(0,q.D)({mutationFn:async()=>{r(),await a.post("/projects/".concat(n,"/handle_error/").concat(t))}});return(0,s.jsx)(tI,{onClick:()=>l(),disabled:i,label:"Dismiss",icon:"close"})}function tO(e){let{error:t,hideFn:r}=e,n=(0,Y.D)(),{onClick:a,isPending:l}=(0,tr.hw)({projectId:n,errors:[t]}),i=(0,_.Eh)(e=>e.isSendChatMessageMutationPending),o=(0,_.Eh)(e=>e.setShowConsole);return(0,s.jsx)(tI,{onClick:()=>{o(null),r(),a()},label:"Try to fix this error",icon:"build",disabled:l||i})}let tF=e=>{let{error:t}=e,[r,n]=(0,l.useState)(!1);return r?null:(0,s.jsxs)("div",{className:"mb-4 mt-2",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center justify-between rounded-t-md border-l border-r border-t border-border bg-popover p-2",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("p",{className:"mr-2 text-sm",children:tD(t.type)}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:tZ(t.created_at)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(tO,{error:t,hideFn:()=>{n(!0)}}),(0,s.jsx)(tT,{errorId:t.id,hideFn:()=>{n(!0)}})]})]}),(0,s.jsx)(tr.UL,{errors:[t],roundedTop:!1})]})},tA=e=>{var t,r,n;let{errors:a,allErrors:l}=e;return a.length!==l.length?(0,s.jsx)("p",{className:"text-sm",children:"At least one of these HTTP calls failed which means that the server or API you're trying to communicate with is not working properly. Unfortunately this is not something that the AI can fix for you since we don't control the server that you're trying to communicate with."}):(0,s.jsxs)("p",{className:"text-sm",children:["This is an HTTP server error which means that the server or API you're trying to communicate with is not working properly.",(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),"Unfortunately this is not something that the AI can fix for you since we don't control the server that you're trying to communicate with.",(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(null===(t=a[0].meta_data)||void 0===t?void 0:t.url)&&!(null===(r=a[0].meta_data)||void 0===r?void 0:r.status)&&(0,s.jsxs)(s.Fragment,{children:["Please validate that the url"," ",(0,s.jsx)("pre",{className:"inline-block rounded bg-secondary p-1",children:null===(n=a[0].meta_data)||void 0===n?void 0:n.url})," ","is correct."]})]})},tL=e=>{let{errors:t}=e;if(!tr.t6[t[0].type])return null;let r=[...t].sort((e,t)=>t.created_at.seconds-e.created_at.seconds),n=r.filter(e=>e.type===tk.N.CORS_ERROR),a=r.filter(e=>e.type===tk.N.HTTP_SERVER_ERROR);return(0,s.jsxs)(s.Fragment,{children:[n.length>0&&(0,s.jsx)(tP,{errors:n,allErrors:t}),a.length>0&&(0,s.jsx)(tA,{errors:a,allErrors:t}),t.map(e=>(0,s.jsx)(tF,{error:e},e.id))]})},tM=()=>{let e=(0,_.Eh)(e=>e.activeConsoleErrorContent),t=(0,Y.v)();if(!t)throw Error("Project ID is required and should always be set here");return e?(0,s.jsx)(tL,{errors:e,projectId:t}):(em.PW.error("No errors to display, this probably shouldn't happen"),null)},tU=(0,te.default)(()=>r.e(346).then(r.bind(r,20346)).then(e=>e.ConsoleDebug),{loadableGenerated:{webpack:()=>[20346]},loading:()=>(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:"Loading debug view..."})}),tJ=()=>{var e;let t=(0,_.Eh)(e=>e.activeConsoleErrorContent),r=(0,_.Eh)(e=>e.consoleContentType),n=(0,Y.v)(),a=(0,tt.qV)({projectId:null!=n?n:"",errorIds:null!==(e=null==t?void 0:t.map(e=>e.id))&&void 0!==e?e:[],setErrors:()=>{}});if("error"!==r||!(null==t?void 0:t.length)||!n)return null;let l=(0,tr.Sv)(t);return(0,s.jsx)("div",{className:"ml-auto flex flex-row items-start",children:l.map((e,r)=>{let l=tr.cb[e];return(0,s.jsx)(l,{errors:t,primary:0===r,projectId:n,handleErrorMutation:a},e)})})},tH=(e,t)=>{let r="".concat(t,"-");switch(e.type){case"text":let s=e.content.trim().substring(0,20)||"empty-text";r+="text-".concat(s);break;case"writing_file":r+="file-".concat(e.file_path);break;case"edit":r+="edit-".concat(e.file_path);break;case"delete":r+="delete-".concat(e.file_path);break;case"rename":r+="rename-".concat(e.original_file_path,"-").concat(e.new_file_path);break;case"add_dependency":r+="add-dep-".concat(e.dependency);break;case"remove_dependency":r+="remove-dep-".concat(e.removed_dependency);break;case"error":let n=e.error_message.trim().substring(0,20)||"empty-error";r+="error-".concat(n);break;case"tool_use":r+="tool-use-".concat(e.name,"-").concat(e.data.substring(0,20));break;default:r+="unknown-".concat(Math.random().toString(36).substring(2,9))}return r},tW=e=>{var t;let{scrollContainerRef:r}=e,n=(0,_.Eh)(e=>e.activeConsoleCodeContent),a=(0,_.Eh)(e=>e.codeViewType),i=(0,_.Eh)(e=>e.activeEdit),o=(0,l.useRef)(null),c=(0,l.useRef)(),d=(0,l.useRef)(!0),u=(0,l.useRef)(!1),m=(0,l.useCallback)(()=>{if(r.current){let{scrollTop:e,scrollHeight:t,clientHeight:s}=r.current;d.current=t-e-s<10}},[r]),h=(0,l.useCallback)(e=>{e.deltaY<0?u.current=!0:u.current=!1},[]),x=(0,l.useCallback)(()=>{u.current=!0},[]),p=(0,l.useCallback)(()=>{u.current=!1},[]);return((0,l.useEffect)(()=>{let e=r.current;return e&&(e.addEventListener("scroll",m),e.addEventListener("wheel",h),e.addEventListener("touchstart",x),e.addEventListener("touchend",p)),()=>{e&&(e.removeEventListener("scroll",m),e.removeEventListener("wheel",h),e.removeEventListener("touchstart",x),e.addEventListener("touchend",p))}},[r,m,h,x,p]),(0,l.useEffect)(()=>{var e,t,s;c.current!==(null===(e=r.current)||void 0===e?void 0:e.scrollHeight)&&(c.current=null===(t=r.current)||void 0===t?void 0:t.scrollHeight,d.current&&!u.current&&(null===(s=o.current)||void 0===s||s.scrollIntoView({behavior:"auto"})))},[n,r]),a===_.es.DIFF)?(0,s.jsx)(tS,{activeEdit:i},null==i?void 0:i.id):(0,s.jsxs)(s.Fragment,{children:[n&&(null===(t=n.parts)||void 0===t?void 0:t.length)>0?n.parts.map((e,t)=>(0,s.jsx)(tw,{part:e},tH(e,t))):null,(0,s.jsx)("div",{ref:o})]})},tG=()=>{let e=(0,_.Eh)(e=>e.activeEdit),t=(0,E.iZ)(e=>e.project),r=(0,l.useMemo)(()=>{if(e&&t)return(0,eW.t)({projectId:null==t?void 0:t.id,sha:e.commit_sha})},[e,t]);return(0,s.jsx)("iframe",{id:"preview-panel",src:"".concat(r,"?forceHideBadge=true"),allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;",className:"min-h-full w-full flex-grow"})},tB=e=>{let{scrollContainerRef:t}=e;switch((0,_.Eh)(e=>e.consoleContentType)){case"error":return(0,s.jsx)(tM,{});case"code":return(0,s.jsx)(tW,{scrollContainerRef:t});case"preview":return(0,s.jsx)(tG,{});case"debug":return(0,s.jsx)(tU,{});default:return(0,s.jsx)("p",{className:"mt-4 text-center",children:"Click on a code chip in the chat to inspect the code output."})}};var tV=()=>{let e=(0,_.Eh)(e=>e.consoleContentType),t=(0,l.useRef)(null);return(0,s.jsx)("div",{className:(0,f.cn)("absolute inset-0 z-50 overflow-y-auto rounded-b-none bg-background p-4 pb-10",{"p-0":"preview"===e}),ref:t,children:(0,s.jsx)(tB,{scrollContainerRef:t})})},tq=r(1266),tK=r(32489),tY=r(95186),t$=r(12339),tQ=r(6827);let tX=(0,l.createContext)({currentFile:null,states:{},openTabs:[],setCurrentFile:()=>{},setStates:()=>{},setOpenTabs:()=>{}});function t0(e){let{children:t}=e,[r,n]=(0,l.useState)(null),[a,i]=(0,l.useState)({}),[o,c]=(0,l.useState)([]),d=(0,l.useMemo)(()=>({currentFile:r,setCurrentFile:n,states:a,setStates:i,openTabs:o,setOpenTabs:c}),[r,a,o]);return(0,s.jsx)(tX.Provider,{value:d,children:t})}let t1=()=>{let e=(0,l.useContext)(tX);if(void 0===e)throw Error("useCodeEditor must be used within a CodeEditorProvider");return e};var t2=r(40875),t4=r(10407),t5=r(69658);function t6(e){var t;let{node:r,setCurrentFile:n,currentFile:a,level:i}=e,[o,c]=(0,l.useState)(i<1),d=null===(t=r.children)||void 0===t?void 0:t.sort((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name));return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:(0,f.cn)("group flex cursor-pointer items-center px-2 py-1 text-sm hover:bg-primary/25",a===r.path&&"!bg-accent/50"),onClick:()=>{"directory"===r.type?c(!o):n(r.path)},role:"button",tabIndex:0,children:[(0,s.jsx)("div",{className:"mr-1 flex-shrink-0",style:{marginLeft:16*i},children:"directory"===r.type?o?(0,s.jsx)(t2.Z,{className:"h-4 w-4"}):(0,s.jsx)(t4.Z,{className:"h-4 w-4"}):null}),"directory"!==r.type&&(0,s.jsx)("div",{className:"mr-1 h-4 w-4 flex-shrink-0",children:(0,s.jsx)(t5.Z,{className:"h-4 w-4"})}),(0,s.jsx)("span",{className:"truncate",children:r.name})]}),"directory"===r.type&&o&&d&&(0,s.jsx)("div",{children:d.map(e=>(0,s.jsx)(t6,{node:e,setCurrentFile:n,currentFile:a,level:i+1},e.path))})]})}function t3(e){let{setCurrentFile:t,code:r,currentFile:n}=e,a=(function(e){let t=[];return e.forEach(e=>{let[r]=e,s=r.split("/"),n=t;s.forEach((e,t)=>{let r=t===s.length-1,a=n.find(t=>t.name===e),l=s.slice(0,t+1).join("/");if(a)r||(n=a.children);else{let t={name:e,path:l,type:r?"file":"directory",...r?{}:{children:[]}};n.push(t),r||(n=t.children)}})}),t})(r).sort((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name));return(0,s.jsx)("div",{className:"overflow-x-auto p-2",children:a.map(e=>(0,s.jsx)(t6,{node:e,setCurrentFile:t,currentFile:n,level:0},e.path))})}function t7(e){let{}=e,[t,r]=(0,l.useState)(!1),{setTab:n}=P(),{syncCode:a,hasUnsavedChanges:i,enableServer:c}=(0,z.v)(),d=D(),u=(0,l.useCallback)(async()=>{r(!0),c();try{let e=tQ.W.getState().pendingChanges;await a(e,{commitMessage:"Code edited in Lovable Code Editor"}),tQ.W.getState().clearPendingChanges(),o.Am.success("Changes saved"),n("preview")}finally{r(!1)}},[c,n,a]),h=(0,l.useCallback)(()=>{tQ.W.getState().clearPendingChanges()},[]);return d?(0,s.jsx)(e4.M,{children:i&&(0,s.jsxs)(C.E.div,{initial:{y:"200%"},animate:{y:0},exit:{y:"200%"},className:"flex w-full items-center justify-end gap-2",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"You have unsaved changes"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(m.z,{variant:"ghost",size:"sm",onClick:h,disabled:t,children:"Discard"}),(0,s.jsx)(m.z,{variant:"default",size:"sm",onClick:u,loading:t,disabled:t,children:"Save changes"})]})]})}):(0,s.jsx)("div",{className:"flex w-full items-center justify-end",children:(0,s.jsx)("div",{className:"w-full text-center text-sm text-muted-foreground",children:"Read Only. If you want to update the code, set up sync with Github."})})}let t9={history:tq.cE},t8=["tailwind.config.lov.json","package-lock.json","bun.lockb","vite-env.d.ts"],re=(e,t)=>e.filter(e=>{let[r]=e;return!t8.some(e=>r.includes(e))&&(!t||r.toLowerCase().includes(t.toLowerCase()))}),rt=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{data:r}=(0,F.a)(B.W.sourceCode({projectId:e,enabled:t}));return(0,l.useMemo)(()=>{var e;return null==r?void 0:null===(e=r.files)||void 0===e?void 0:e.filter(e=>{let{binary:t}=e;return!t}).map(e=>{let{name:t,contents:r}=e;return[t,r]})},[r])};function rr(e){let{projectId:t}=e,{code:r,hasInitialCode:n,addPendingChange:a}=(0,z.v)(),{currentFile:i,setCurrentFile:o,states:c,setStates:d,openTabs:u,setOpenTabs:m}=t1(),h=(0,tQ.W)(e=>e.pendingChanges),x=rt(t,!n),p=(0,l.useMemo)(()=>n?r:x,[x,n,r]),v=null==p?void 0:p.length;(0,l.useEffect)(()=>{if(i||!v)return;let e=null==p?void 0:p.find(e=>{let[t,r]=e;return t.endsWith("pages/Index.tsx")});e&&o(e[0])},[v]);let j=D(),g=(0,l.useMemo)(()=>{var e;if(i)return i in h?h[i]:null==p?void 0:null===(e=p.find(e=>{let[t,r]=e;return t===i}))||void 0===e?void 0:e[1]},[p,i,h]),[b,y]=(0,l.useState)(""),w=(0,l.useMemo)(()=>re(null!=p?p:[],b),[p,b]);(0,l.useEffect)(()=>{i&&!u.includes(i)&&m([...u,i])},[i,u,m]);let N=(0,l.useCallback)((e,t)=>{e&&a(e,t)},[a]);return(0,s.jsxs)("div",{className:"relative flex h-full w-full",children:[(0,s.jsxs)("div",{className:"w-64 flex-shrink-0 flex-grow-0 overflow-y-auto border-r border-border",children:[(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)(tY.I,{placeholder:"Search",value:b,onChange:e=>y(e.target.value)})}),v?(0,s.jsx)(t3,{setCurrentFile:o,currentFile:i,code:w}):(0,s.jsx)("div",{className:"flex items-center justify-center pb-16",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Starting Live Preview..."})}),(0,s.jsx)("div",{className:"pb-12"})]}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden bg-muted p-0",children:[(0,s.jsx)(t$.mQ,{value:i||"",onValueChange:o,className:(0,f.cn)({hidden:!i}),children:(0,s.jsx)(t$.dr,{className:"h-auto w-full justify-start overflow-x-auto rounded-none bg-background p-0 scrollbar-hide",children:u.map(e=>(0,s.jsxs)(t$.SP,{value:e,className:"group relative rounded-none border-r px-2 pl-3 data-[state=active]:!bg-muted-active data-[state=active]:text-foreground hover:bg-muted/50","data-state":i===e?"active":"inactive",children:[(0,s.jsx)("span",{children:e}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),t.preventDefault(),m(u.filter(t=>t!==e)),i===e&&o(u.find(t=>t!==e)||null)},className:"ml-2 opacity-0 transition-opacity group-hover:opacity-100 group-data-[state=active]:opacity-100",children:(0,s.jsx)(tK.Z,{className:"size-4"})})]},e))})}),(0,s.jsx)("div",{className:(0,f.cn)("flex w-full flex-1 overflow-y-auto bg-muted",th().editor),children:i&&(0,s.jsx)(ts.ZP,{readOnly:!j,initialState:c[i]?{json:c[i],fields:t9}:void 0,onChange:(e,t)=>{if(i){let e=t.state.toJSON(t9);d(t=>({...t,[i]:e}))}N(i,e)},value:g,className:"flex-1 overflow-y-auto",theme:td,extensions:[...tu,ts.tk.editable.of(!!j)]},i)})]})]})}var rs=r(61563),rn=r(96771);let ra=e=>{let{diffAvailable:t}=e,r=(0,_.Eh)(e=>e.codeViewType),n=(0,_.Eh)(e=>e.setCodeViewType),a=(0,_.Eh)(e=>e.activeEdit);return(0,s.jsxs)(rs.t,{className:"ml-auto",type:"single",variant:"outline",value:r,defaultValue:_.es.RAW,onValueChange:e=>{e&&(n(e),e===_.es.RAW?u.ZP.capture(p.S.PREVIEW.RAW_TAB_CLICKED):e===_.es.DIFF&&u.ZP.capture(p.S.PREVIEW.DIFF_TAB_CLICKED))},children:[(null==a?void 0:a.type)!==rn.I.type.REVERT&&(0,s.jsx)(rs.G,{size:"sm",value:_.es.RAW,children:"Raw"}),(0,s.jsx)(rs.G,{size:"sm",disabled:!t,value:_.es.DIFF,children:"Diff"})]})};var rl=r(66070);let ri=e=>{let{projectId:t,errors:r,allErrors:n,setErrors:a,canAIFix:i}=e,{onClick:o,isPending:c}=(0,tr.hw)({projectId:t,errors:n}),d=(0,_.Eh)(e=>e.consoleContentType),[u,x]=(0,l.useState)(!1),[p,f]=(0,l.useState)(!1),v=(0,_.Eh)(e=>e.isSendChatMessageMutationPending),j=(0,_.Eh)(e=>e.setShowConsole),g=(0,_.Eh)(e=>null!==e.consoleContentType),b=(0,_.Eh)(e=>e.setConsoleErrorContent),y=(0,tt.qV)({projectId:t,errorIds:r.map(e=>e.id),setErrors:a});return(0,l.useEffect)(()=>{r&&0!==r.length?x(!0):x(!1)},[r]),(0,s.jsx)("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 overflow-hidden",style:{height:"100%"},children:(0,s.jsx)("div",{className:"pointer-events-auto absolute bottom-0 left-1/2 mb-4 -translate-x-1/2 transform shadow-lg transition-all duration-500 ease-in-out ".concat(u?"translate-y-0 opacity-100":"translate-y-full opacity-0"),onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:(0,s.jsxs)(rl.Zb,{className:"p-1",children:[(0,s.jsx)(rl.aY,{className:"p-4",children:(0,s.jsx)("div",{className:"flex w-full flex-col items-start justify-start",children:(0,s.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"mb-1 flex",children:[(0,s.jsx)(h.Z,{name:"warning",size:"large",className:"mr-2 text-warning"}),(0,s.jsx)("p",{className:"text-m font-bold",children:"Error"})]}),(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:tr.v7[r[0].type]})})]}),(0,s.jsxs)("div",{className:"flex-basis-0 flex min-w-[110px] flex-shrink flex-wrap justify-end gap-2",children:[i&&(0,s.jsx)(e3.z,{variant:"default",className:"w-full max-w-[110px] justify-evenly py-1",onClick:()=>{a([]),o()},disabled:c||v||g,hotkey:"F",showHotkey:!0,children:"Try to fix"}),(0,s.jsx)(e3.z,{variant:"outline",className:"w-full max-w-[110px] justify-evenly py-1",onClick:()=>{b(n),j("error"===d?null:"error")},hotkey:"L",showHotkey:!0,children:"Show logs"})]})]})})})}),p&&(0,s.jsx)("div",{className:"absolute right-0 top-0",children:(0,s.jsx)(m.z,{variant:"ghost",size:"icon",onClick:()=>{y.mutate()},className:"h-6 w-6",children:(0,s.jsx)(tK.Z,{className:"h-4 w-4"})})})]})})})},ro=e=>{let{projectId:t}=e,{errors:r,setErrors:n}=(0,tt.hT)({projectId:t}),a=null==r?void 0:r.filter(e=>!e.message_id);if(!a||0===a.length||!r)return null;let l=(0,tr.Sv)(a).includes(tr.eX.AI_FIX);return(0,s.jsx)(ri,{projectId:t,allErrors:r,errors:a,setErrors:n,canAIFix:l})},rc=()=>{let e=(0,Y.v)();return e?(0,s.jsx)(ro,{projectId:e}):(em.PW.error("projectId is not defined, this should not happen"),null)},rd=e=>{let{children:t}=e;return(0,s.jsxs)(s.Fragment,{children:[t,(0,s.jsx)(rc,{})]})};var ru=r(97226),rm=r(51817),rh=r(11594),rx=r(33145);let rp=[{icon:"dock_to_right",text:"Chat with AI in the sidebar"},{icon:"location_searching",text:"Select specific elements to modify"},{icon:"imagesmode",text:"Upload images as a reference"},{icon:"preview",text:"Instantly preview your changes"},{icon:"school",text:"Set custom knowledge for every edit"},{icon:"database",text:"Connect Supabase for backend"},{icon:"code_blocks",text:"Collaborate at source, via GitHub"},{icon:"globe",text:"Deploy when you're ready"}],rf=e=>{let{text:t="Setting up..."}=e,r=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let e=r.current;if(!e)return;let t=()=>{e.style.transform="translateY(0)"};return e.addEventListener("animationiteration",t),()=>e.removeEventListener("animationiteration",t)},[]),(0,s.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-8",children:[(0,s.jsx)(rx.default,{src:"/img/lovable.svg",alt:"lovable logo",width:100,height:100}),(0,s.jsx)("span",{children:t}),(0,s.jsxs)("div",{className:"w-100 relative mx-auto h-48 overflow-hidden rounded-lg bg-muted/50",children:[(0,s.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 z-10 h-12 bg-gradient-to-b from-muted to-transparent"}),(0,s.jsx)("div",{ref:r,className:"animate-slide-up",children:[...rp,...rp].map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 transition-colors",children:[(0,s.jsx)(h.Z,{name:e.icon,className:"h-5 w-5 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:e.text})]},t))}),(0,s.jsx)("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 z-10 h-12 bg-gradient-to-t from-muted to-transparent"})]})]})},rv=e=>{let{refetch:t,description:r,isLoading:n}=e,[a,i]=(0,l.useState)(!1);return(0,s.jsxs)("div",{className:"bg-navy-900 flex h-full w-full flex-col items-center justify-center",children:[(0,s.jsx)(ru.Z,{className:"mb-4 text-foreground",size:48}),(0,s.jsx)("h1",{className:"mb-6 text-2xl text-foreground",children:r}),a||n?(0,s.jsxs)(m.z,{variant:"default",className:"w-48",disabled:!0,children:[(0,s.jsx)("span",{className:"mr-2",children:"Starting"}),(0,s.jsx)(rm.Z,{className:"h-4 w-4 animate-spin"})]}):(0,s.jsx)(m.z,{variant:"default",className:"w-48",onClick:async()=>{i(!0);try{await t()}catch(e){em.PW.error("ERROR STARTING DEVSERVER",{error:e})}},children:"Start project"})]})},rj=e=>{var t;let{children:r,projectId:n,baseUrl:a,shouldDisplayDeployPreview:i,justStarted:o}=e,{refetch:c,isLoading:d,data:u,error:m,isFetching:h}=(0,rh.i)({projectId:n,enabled:!1,userInitiated:!0}),[x,p]=(0,l.useState)("starting"),[f,v]=(0,l.useState)(!1),j=(0,_.Eh)(e=>e.shouldShowTipsAndTricksOnDevServerStart),g=(0,l.useRef)(!1);(0,l.useEffect)(()=>{j&&(g.current=!0)},[j]),(0,l.useEffect)(()=>{"starting"!==x&&g.current&&!j&&(g.current=!1)},[x,j]);let{status:b,initialized:y,error:w}=function(e,t){let r=(0,Y.v)(),[s,n]=(0,l.useState)(!1),{data:a,isLoading:i,error:o,isStale:c}=(0,F.a)({queryKey:X.iZ.devServerStatus(r),enabled:t,staleTime:23e4,queryFn:async()=>{try{let t=new AbortController,r=setTimeout(()=>t.abort(),3e3);try{let r=await fetch("".concat(e,"/_sandbox/dev-server"),{signal:t.signal}),s=await r.json();return em.PW.debug("devserver_status_from_api",{state:null==s?void 0:s.state,initialized:null==s?void 0:s.initialized}),{state:null==s?void 0:s.state,initialized:null==s?void 0:s.initialized}}finally{clearTimeout(r)}}catch(e){throw e instanceof Error&&(e.message.includes("NetworkError")||e.message.includes("operation was aborted"))&&em.PW.debug("devserver_error_from_api",{error:e}),e}},refetchInterval:s?6e4:1e3,refetchIntervalInBackground:!1});return(0,l.useEffect)(()=>{c||(null==a?void 0:a.state)!=="started"?n(!1):n(!0)},[c,null==a?void 0:a.state]),{status:c?"unknown":(null==a?void 0:a.state)||null,initialized:(null==a?void 0:a.initialized)||null,isLoading:i,error:o}}(a,!!a&&(null==u?void 0:null===(t=u.status)||void 0===t?void 0:t.sandbox)=="started"),N=(0,V.NL)();if((0,l.useEffect)(()=>{"ready"==x&&w&&!f&&(N.invalidateQueries({queryKey:X.iZ.devServer(n)}),v(!0))},[f,w,h,x]),(0,l.useEffect)(()=>{f&&v(!1)},[f,u,m]),(0,l.useEffect)(()=>{var e;let t=(null==u?void 0:null===(e=u.status)||void 0===e?void 0:e.sandbox)||"starting",r=x;f?r="starting":"unknown"===b?r="starting":"error"==t||m?r="sandbox_error":"starting"===t?r="starting":"started"===t&&(r="error"===b?"devserver_error":"started"===b?"ready":"starting"),x!==r&&p(r)},[d,b,w,u,m,f]),(j||g.current||!i)&&"starting"==x)return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"flex flex-grow items-center justify-center bg-muted",children:(0,s.jsx)(rf,{text:"Spinning up preview..."})})});if("ready"==x||"starting"==x||i)return(0,s.jsxs)("div",{className:"relative flex flex-grow flex-col",children:[r,(0,s.jsx)(e4.M,{children:"starting"===x&&!i&&(0,s.jsx)(C.E.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},transition:{type:"spring",damping:20,stiffness:300},className:"pointer-events-none absolute bottom-0 left-0 right-0 flex items-center justify-center pb-2",children:(0,s.jsx)(rl.Zb,{className:"pointer-events-auto bg-muted p-4 px-6",children:(0,s.jsx)(rl.aY,{className:"p-0",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(rm.Z,{className:"h-5 w-5 animate-spin text-foreground"}),(0,s.jsx)("p",{className:"text-sm text-foreground",children:"Spinning up Sandbox..."})]})})})})})]});if("starting"==x)return(0,s.jsx)("div",{className:"relative flex flex-grow flex-col",children:r});if("sandbox_error"!=x&&"devserver_error"!=x)return em.PW.error("unexpected mode",{mode:x,devServerStatus:status,startSandboxResp:u}),(0,s.jsx)(s.Fragment,{children:r});{em.PW.debug("devserver_not_running",{status:b,initialized:y});let e="sandbox_error"==x?"Could not start sandbox machine":"Could not start dev server";return(0,s.jsx)(rv,{refetch:c,description:e,isLoading:d})}},rg=e=>{let{children:t,device:r,className:n}=e,a=(0,l.useMemo)(()=>"mobile"===r?{width:"375px",height:"100%"}:{width:"100%",height:"100%"},[r]);return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col transition-all ease-in-out",n),style:{width:a.width,height:a.height},children:t})},rb=[{name:"mobile",title:"Switch to mobile preview mode",icon:"phone_iphone",description:"Enter mobile preview mode"},{name:"desktop",title:"Switch to desktop preview mode",icon:"laptop_mac",description:"Enter desktop preview mode"}],ry=e=>{let{onChange:t,value:r}=e,n=rb[(rb.findIndex(e=>e.name===r)+1)%rb.length];return(0,s.jsxs)(x.u,{children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)(m.z,{className:"hidden gap-1.5 md:flex",variant:"ghost",size:"icon-sm",onClick:()=>{t(n.name)},children:(0,s.jsx)(h.Z,{name:n.icon,size:"small"})})}),(0,s.jsx)(x._v,{side:"bottom",children:n.title})]})};var rw=r(2925),rN=e=>{let{onRefresh:t,url:r,urlToDisplay:n,pages:a}=e,i=(0,rw.u)(e=>e.setCurrentPage),o="";if(r)try{o=new URL(r).pathname,"/"===o[0]&&(o=o.substring(1)),"/"===o.trim()&&(o="index")}catch(e){}return(0,l.useEffect)(()=>{i(o||"index")},[o,i]),(0,s.jsx)(s.Fragment,{children:a?(0,s.jsxs)("div",{className:"flex items-center gap-[4px] px-1.5 text-sm",children:[(0,s.jsx)("p",{className:"hidden text-sm font-medium text-muted-foreground @sm:flex",children:n}),(0,s.jsx)("p",{className:"hidden text-sm font-medium text-muted-foreground @sm:flex",children:"/"}),(0,s.jsxs)(M.h_,{children:[(0,s.jsx)(M.$F,{asChild:!0,children:(0,s.jsxs)("div",{className:"flex cursor-pointer items-center hover:opacity-75",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:o||"index"}),(0,s.jsx)(h.Z,{name:"keyboard_arrow_down",className:"relative top-[1px] h-4 w-4"})]})}),(0,s.jsx)(M.AW,{className:"max-h-[600px] min-w-[200px] overflow-y-auto bg-background",align:"start",collisionPadding:8,sideOffset:20,alignOffset:-40,children:a.map(e=>(0,s.jsxs)(M.bO,{onClick:()=>{if(!r)return;let s=new URL(r);s.pathname=e.path,t(s.toString()),i(e.name)},className:"flex flex-col items-start gap-0",checked:e.path.substring(1)===o,children:[e.name,(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:e.path})]},e.path))})]})]}):(0,s.jsx)("p",{className:"hidden px-1.5 text-sm @sm:flex",children:(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:n})})})};let r_=e=>{var t;let{openGithubRequiredDialog:r}=e,n=(0,_.Eh)(e=>e.exitConsole),a=(0,_.Eh)(e=>e.activeEdit),l=(0,E.iZ)(e=>e.project),i=(0,_.Eh)(e=>e.consoleContentType),{setTab:o}=P();return(0,s.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,s.jsxs)(e3.z,{variant:"ghost",size:"sm",onClick:()=>{u.ZP.capture(p.S.CONSOLE.EXITED_VIA_BUTTON),n(),o("preview")},className:"flex items-center gap-2",hotkey:"esc",showHotkey:!0,hotkeyOptions:{enableOnFormTags:!0},children:[(0,s.jsx)(h.Z,{name:"chevron_left",size:"small"}),"Exit"]}),(null==a?void 0:a.commit_sha)&&(0,s.jsx)(e3.z,{variant:"ghost",size:"sm",onClick:()=>{var e,t;let s=(0,e6._J)((null==l?void 0:l.github_repo_name)||"",a.commit_sha||"",null==l?void 0:null===(e=l.github_owner)||void 0===e?void 0:e.name);if((null==l?void 0:null===(t=l.github_owner)||void 0===t?void 0:t.name)===e6.aR){r();return}s&&window.open(s,"_blank")},hotkey:"G",showHotkey:!0,children:"View on GitHub"}),"code"===i&&(0,s.jsx)(ra,{diffAvailable:!!(null==a?void 0:null===(t=a.diff)||void 0===t?void 0:t.length)}),"error"===i&&(0,s.jsx)(tJ,{})]})},rE=e=>{let{handleRefresh:t,iframeUrl:r,baseSandboxUrl:n,pages:a,device:l,setDevice:i}=e,o=(0,E.iZ)(e=>e.project),c=(0,_.Eh)(e=>e.customScript),d=(0,_.Eh)(e=>e.setCustomScript),{tab:u}=P();return(0,s.jsx)("div",{className:"flex w-full items-center justify-between gap-2 @container",children:(0,s.jsx)("div",{className:"flex w-full items-center gap-2",children:(0,s.jsxs)(e4.M,{mode:"wait",children:["code"!==u&&(0,s.jsxs)(C.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.1},className:"flex w-full items-center justify-between",children:[(0,s.jsx)("div",{}),(0,s.jsx)(rN,{onRefresh:t,url:r,urlToDisplay:(null==o?void 0:o.name)&&(0,eh.P)((0,eW.t)({projectName:o.name})).replace(/\/+$/,""),pages:a}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(e7.Z,{label:"Open preview in new tab",children:(0,s.jsx)("a",{href:(null==o?void 0:o.name)?(0,eW.t)({projectName:null==o?void 0:o.name}):"#",target:"_blank",rel:"noreferrer",onClick:e=>{e.altKey&&n&&(e.preventDefault(),window.open(n,"_blank"))},children:(0,s.jsx)(m.z,{variant:"ghost",size:"icon-sm",children:(0,s.jsx)(h.Z,{name:"arrow_outward",size:"small"})})})}),(0,s.jsx)(ry,{value:l,onChange:i}),(0,s.jsx)(e7.Z,{label:"Refresh page",children:(0,s.jsx)(m.z,{variant:"ghost",size:"icon-sm",onClick:()=>t(),children:(0,s.jsx)(h.Z,{name:"refresh",size:"small"})})}),c&&(0,s.jsx)(e7.Z,{label:"Override script to ".concat("http://localhost:8001/gptengineer.js"),children:(0,s.jsx)(m.z,{variant:"ghost",size:"icon-sm",onClick:()=>d(!c),className:(0,f.cn)(c&&"bg-accent"),children:(0,s.jsx)(h.Z,{name:"code",size:"small"})})})]})})]},"preview-controls"),"code"===u&&(0,s.jsx)(C.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.1},className:"flex w-full items-center justify-between",children:(0,s.jsx)(t7,{})},"code-controls")]})})})};function rC(e){let{handleRefresh:t,iframeUrl:r,baseSandboxUrl:n,preview:a,projectId:i,devServerEnabled:o}=e,{open:c,GithubRequiredDialog:d}=e5(),{edits:u}=e8({projectId:i}),[m,h]=(0,l.useState)("desktop"),x=(0,l.useMemo)(()=>{var e,t;return null!==(t=null==u?void 0:null===(e=u.findLast(e=>e.pages))||void 0===e?void 0:e.pages)&&void 0!==t?t:void 0},[u]),p=(0,_.Eh)(e=>e.consoleContentType),{tab:f,setTab:v}=P(),j=(0,E.iZ)(e=>e.project);return(0,l.useEffect)(()=>{p?v("console"):v("preview")},[v,p]),(0,s.jsxs)("div",{className:"flex flex-grow flex-col",children:[(0,s.jsx)(d,{}),(0,s.jsx)("div",{className:"flex h-12 w-full items-center justify-between overflow-hidden rounded-t-xl border border-b-0 border-border bg-muted px-3",children:"console"===f?(0,s.jsx)(r_,{openGithubRequiredDialog:c}):(0,s.jsx)(rE,{handleRefresh:t,iframeUrl:r,baseSandboxUrl:n,pages:x,device:m,setDevice:h})}),(0,s.jsxs)("div",{className:"relative mb-2 flex flex-grow flex-col items-center overflow-hidden rounded-b-xl border",children:[(0,s.jsx)("div",{className:"flex h-full w-full flex-grow items-center justify-center",children:(0,s.jsx)(rg,{device:m,className:"justify-center",children:(0,s.jsx)("div",{className:"relative flex min-h-full w-full flex-grow overflow-auto",children:(0,s.jsx)(rj,{baseUrl:null!=n?n:null,projectId:i,shouldDisplayDeployPreview:!o&&!!(null==j?void 0:j.preview_build_commit_sha),justStarted:u.length<2,children:(0,s.jsx)(rd,{children:a})})})})}),(0,s.jsx)(t0,{children:(0,s.jsxs)(e4.M,{mode:"wait",children:["console"===f&&(0,s.jsx)(C.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 z-10 bg-background",children:(0,s.jsx)(tV,{})},"console"),"code"===f&&(0,s.jsx)(C.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 z-10 flex bg-background",children:(0,s.jsx)(rr,{projectId:i})},"code")]})})]})]})}var rS=r(19060),rk=r(26815);let rP=e=>{let t=(0,E.iZ)(e=>e.project),r=(0,_.Eh)(e=>e.userProjectPermissions),[n,a]=l.useState(!1),i=!!(null==t?void 0:t.is_supabase_enabled)||!!(null==t?void 0:t.supabase_project_config),o=r.edit||!i;return(0,s.jsx)(ex.Vq,{...e,children:(0,s.jsxs)(ex.cZ,{className:"py-16 text-center",children:[(0,s.jsx)(ex.fK,{children:(0,s.jsx)(ex.$N,{className:"flex items-center justify-center gap-2 text-center text-2xl",children:e.isRemixing?(0,s.jsxs)(s.Fragment,{children:["Remixing the project",(0,s.jsx)(rm.Z,{size:20,className:"animate-spin"})]}):"Remix the project"})}),e.isRemixing?(0,s.jsx)("p",{children:"Stay put while we are setting it up!"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"By remixing a project, you will create a copy that you own."}),!o&&(0,s.jsx)("p",{className:"text-destructive",children:"You do not have permission to remix this project because it uses Supabase."}),(0,s.jsxs)("div",{className:"mt-4 flex items-center justify-start gap-2",children:[(0,s.jsx)(rS.X,{id:"include-history",disabled:!r.edit,checked:n,onCheckedChange:e=>a(e)}),(0,s.jsx)(rk._,{htmlFor:"include-history",children:"Include project history"})]}),(0,s.jsxs)(m.z,{disabled:!o,onClick:()=>e.onRemix({includeHistory:n}),className:"flex items-center gap-1",children:[(0,s.jsx)(h.Z,{name:"shuffle",size:"small"}),"Remix"]})]})]})})};var rz=r(44895),rR=r(33910),rI=r(43310);let rZ=e=>{let{open:t,onOpenChange:r,setOpen:n,projectName:a,githubOwner:i}=e,{installations:o}=(0,rR.D)(),c=(0,eD.CR)(),d=(0,l.useMemo)(()=>{if(!i||!o)return null;let e=o.find(e=>i.name===e.account.login);return e?e.html_url:null},[i,o]),[u,h]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{c&&("repo_accessible"===c.accessibility?n(!1):u||(n(!0),h(!0)))},[c,n,u,h]),(0,s.jsx)(ex.Vq,{open:t,onOpenChange:r,children:(0,s.jsxs)(ex.cZ,{children:[(0,s.jsx)(ex.fK,{children:(0,s.jsx)(ex.$N,{className:"text-2xl",children:"We can't access your repository"})}),(()=>{switch(null==c?void 0:c.accessibility){case"repo_not_accessible":return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-l",children:"If you want to keep using Lovable to improve your project:"}),(0,s.jsxs)("ol",{className:"mt-4 list-inside list-decimal",children:[(0,s.jsxs)("li",{children:["Go to the"," ",d?(0,s.jsx)("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:"GitHub App settings"}):(0,s.jsx)("strong",{children:" GitHub App settings"})]}),(0,s.jsxs)("li",{children:["Grant ",(0,s.jsx)("strong",{children:"Repository access"})," to"," ",i&&a?(0,s.jsxs)("strong",{children:[i.name,"/",a]}):(0,s.jsx)("strong",{children:"your project"}),"."]})]}),(0,s.jsx)(rD,{appSettingsUrl:d})]});case"installation_not_found":return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"text-l",children:["We couldn't find the Lovable GitHub app installation for your"," ",(null==i?void 0:i.type)==="Organization"?"organization":"account",". To resolve this issue, please connect the GitHub app again."]}),(0,s.jsx)("div",{className:"mt-4 flex justify-center",children:(0,s.jsx)(m.z,{className:"ml-2",size:"lg",onClick:()=>{(0,rz.yA)((0,rz.Mw)(i))},children:"Install GitHub App"})})]});case"unauthorized":return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-l",children:"We don't have the necessary permissions to access your repository."}),(0,s.jsx)(rI.q,{})]});case"installation_suspended":return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"text-l",children:["The GitHub app installation for your"," ",(null==i?void 0:i.type)==="Organization"?"organization":"account"," ","has been suspended."," ",d?(0,s.jsxs)(s.Fragment,{children:["To resolve this issue, visit your"," ",(0,s.jsx)("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:"GitHub App settings"})," ","and unsuspend the Lovable GitHub app installation."]}):(0,s.jsx)(s.Fragment,{children:"Please navigate to your GitHub App settings and unsuspend the Lovable app installation. You can find it under your GitHub account or organization's settings."})]}),(0,s.jsx)(rD,{appSettingsUrl:d})]});case"repo_not_found":return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-l",children:"We couldn't find the specified repository in your GitHub account. Please reach out to us on Discord for further assistance:"}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(m.z,{variant:"outline",asChild:!0,children:(0,s.jsxs)("a",{href:"https://discord.gg/lovable-dev",target:"_blank",title:"Join the Discord server",className:"flex items-center gap-2",children:[(0,s.jsx)("span",{children:"Talk to us on Discord"}),(0,s.jsx)(rx.default,{width:24,height:24,src:"/img/discord.svg",alt:"Discord"})]})})})]});default:return null}})()]})})},rD=e=>{let{appSettingsUrl:t}=e;return(0,s.jsx)("div",{className:"mt-4 flex justify-center",children:t&&(0,s.jsx)(m.z,{className:"ml-2",size:"lg",onClick:()=>{window.open(t,"_blank")},children:"App settings"})})};var rT=r(29461),rO=r(83856),rF=r(9476);let rA=e=>{let{project:t}=e,r=(0,eD.CR)(),[n,a]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{(null==r?void 0:r.accessibility)&&(null==r?void 0:r.accessibility)!==eB.T.accessibility.REPO_ACCESSIBLE&&a(!0)},[null==r?void 0:r.accessibility]),(0,s.jsx)(rZ,{open:n,onOpenChange:a,setOpen:a,projectName:null==t?void 0:t.name,githubOwner:null==t?void 0:t.github_owner})},rL=e=>{var t;let{children:r,projectId:c,baseSandboxUrl:d,iframeBaseUrl:u,devServerEnabled:h,refreshPreview:x,preview:p,iframeUrl:v}=e,j=(0,a.useRouter)(),[b,w]=(0,l.useState)(!0),N=(0,_.Eh)(e=>e.isRemixDialogOpen),C=(0,_.Eh)(e=>e.setIsRemixDialogOpen),S=(0,_.Eh)(e=>e.isSomeRevertMutationPending),k=(0,rw.u)(e=>e.currentPage),P=(0,E.iZ)(e=>e.project);(0,eH.m)(),(0,l.useEffect)(()=>{(null==P?void 0:P.name)&&(document.title="".concat(P.name," - Lovable"))},[null==P?void 0:P.name]);let z=(0,_.Eh)(e=>e.userProjectPermissions),R=!(0,_.Eh)(e=>e.userProjectPermissionsLoading)&&(null==z?void 0:z.edit)===!1,I=(0,l.useRef)(null),Z=(0,y.Z)("md"),D=(0,l.useCallback)(()=>{w(!1)},[]),T=(0,l.useCallback)(()=>{w(!0)},[]),O=(0,l.useCallback)(()=>{w(!b)},[b]);(0,l.useEffect)(()=>{var e,t;b?null===(e=W.current)||void 0===e||e.expand():null===(t=W.current)||void 0===t||t.collapse()},[b]),(0,l.useEffect)(()=>{R&&D()},[D,R]),(0,i.y1)("mod+b",e=>{e.preventDefault(),O()},{enableOnFormTags:!0},[O]);let{mutate:F,isPending:L}=(0,rF.o)({onSubmit:()=>C(!0)}),M=(0,l.useCallback)(e=>{let{includeHistory:t}=e;F({projectId:c,includeHistory:t})},[F,c]),U=(0,l.useCallback)(e=>{x(e)},[x]);(0,l.useEffect)(()=>{S&&"index"===k&&U("".concat(u))},[k,U,S,u]);let J=(0,_.Eh)(e=>e.reset),H=(0,et.ZP)(e=>e.reset);(0,l.useEffect)(()=>()=>{window.location.pathname.startsWith("/projects/".concat(c))||(em.PW.info("Clearing editor state, since route changed to: ".concat(window.location.pathname)),J(),H(),rO.QE.length=0)},[J,H,c]);let W=(0,l.useRef)(null),G=(0,g.useMinPanelSize)(),B=(0,g.usePanelStore)(e=>e.panelSizes),V=(0,g.usePanelStore)(e=>e.updatePanelSizes),q=(0,rT.z)(eZ),K=eP();return(0,l.useEffect)(()=>{K&&o.Am.warning("Update Project",{description:"Your project is out of date",id:"project-update-toast",duration:1/0,action:(0,s.jsx)(m.z,{className:"ml-auto",variant:"accent",onClick:()=>{q({childProps:{}})},children:"Update project"})})},[K,q]),(0,s.jsxs)("div",{className:"flex h-dvh flex-col",children:[(0,s.jsx)("div",{className:"sticky top-0 z-50 w-full",children:(0,s.jsx)(eT.E,{})}),(0,s.jsxs)("div",{className:"flex min-h-0 flex-1 flex-col bg-background",children:[(0,s.jsx)(A.rG,{}),(0,s.jsx)(e1.Y,{}),(0,s.jsx)(rT.RootDialog,{}),P&&!P.git_on_s3&&!P.is_github&&(0,s.jsx)(e2,{open:!0,onOpenChange:()=>j.push("/")}),(null==z?void 0:z.edit)&&P&&(0,s.jsx)(rA,{project:P}),(0,s.jsx)(rP,{onRemix:M,isRemixing:L,open:N,onOpenChange:C}),(0,s.jsx)(ek,{isSidebarOpen:b,toggleSidebar:O,openSidebar:T,hideButtons:R}),(0,s.jsxs)("main",{className:"relative isolate flex min-h-0 flex-1",ref:I,children:[Z&&(0,s.jsxs)("div",{className:"flex min-h-0 flex-1 px-2 md:hidden",children:[(0,s.jsx)(eM.dy,{open:b,onOpenChange:e=>w(e),direction:"left",container:I.current,modal:!0,repositionInputs:!1,children:(0,s.jsxs)(eM.sc,{className:"absolute inset-y-0 bottom-0 left-0 right-auto h-full min-w-[308px] border-l-0 focus:outline-none",showCloseButton:!1,onOpenAutoFocus:e=>e.preventDefault(),autoFocus:!1,"aria-describedby":void 0,onPointerDownOutside:e=>{let t=I.current,r=e.target;(null==t?void 0:t.contains(r))||e.preventDefault()},overlayProps:{className:"absolute"},children:[(0,s.jsx)(n.T,{children:(0,s.jsx)(eM.iI,{children:"Chat panel"})}),r]})}),(0,s.jsx)(rC,{handleRefresh:U,iframeUrl:null!=v?v:"",baseSandboxUrl:null!=d?d:null,preview:p,projectId:c,devServerEnabled:h})]}),!Z&&(0,s.jsx)("div",{className:"hidden min-h-0 flex-1 md:flex",children:(0,s.jsxs)(eF,{direction:"horizontal",className:"relative flex min-h-0 flex-1 flex-row",autoSaveId:"editor-resizable-panels",onLayout:e=>{e&&(e[0]>0&&(document.cookie="react-resizable-panels:layout=".concat(JSON.stringify(e),"; path=/projects")),V(e))},children:[(0,s.jsx)(eA,{collapsible:!0,onExpand:T,onCollapse:D,defaultSize:null!==(t=B[0])&&void 0!==t?t:g.DEFAULT_SIDEBAR_SIZE,minSize:G,collapsedSize:0,className:(0,f.cn)("relative inset-y-0 z-40 mr-0 flex h-full min-h-0 overflow-x-hidden bg-background"),ref:W,children:r}),(0,s.jsx)(eL,{className:"z-[10000] ml-2",tooltip:"Drag to resize"}),(0,s.jsx)(eA,{minSize:40,defaultSize:B[1]||100-g.DEFAULT_SIDEBAR_SIZE,className:"relative flex flex-1 flex-col pr-2",id:"preview-panel",children:(0,s.jsx)(rC,{handleRefresh:U,iframeUrl:null!=v?v:"",baseSandboxUrl:null!=d?d:null,preview:p,projectId:c,devServerEnabled:h})})]})})]}),(0,s.jsx)(eV,{})]})]})};function rM(e){let{children:t}=e,{project_id:r}=(0,a.useParams)();return(0,s.jsx)(E.jI,{projectId:r,children:(0,s.jsx)(eG.mC,{children:(0,s.jsx)(rU,{children:t})})})}function rU(e){var t,r;let{children:n}=e,a=(0,E.iZ)(e=>e.projectId),i=(0,_.Eh)(e=>e.userProjectPermissions),o=(0,_.Eh)(e=>e.customScript),[c,d]=(0,l.useState)(!1),{data:u}=(0,rh.i)({projectId:a,enabled:i.edit&&c}),{edits:m}=e8({projectId:a}),h=(0,l.useRef)(m.length);(0,l.useEffect)(()=>{m.length!==h.current&&i.edit&&d(!0),h.current=m.length},[m.length,i]);let p=(0,l.useRef)(""),f=(0,rh.N)(),v=c&&f.url?f.url:null!==(r=null==u?void 0:u.url)&&void 0!==r?r:null,[j,g]=(0,l.useState)(a?(0,eW.t)({projectId:a}):"");(0,l.useEffect)(()=>{let e=async()=>{if(!c&&j)try{let e=await fetch(j,{method:"HEAD"});200!==e.status&&d(!0)}catch(e){d(!0)}};j!==p.current&&(e(),p.current=j)},[j,c]),(0,l.useEffect)(()=>{v&&g(v)},[v]),e0(),eJ();let{preview:b,refresh:y,url:w}=(0,rO.uL)({baseUrl:j,hidden:!j,projectId:a,useCustomScript:o}),[N,C]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{var e;c&&((null===(e=f.status)||void 0===e?void 0:e.checked_at)&&!N?y():C(!1))},[null===(t=f.status)||void 0===t?void 0:t.checked_at,c]),(0,s.jsx)(x.pn,{delayDuration:550,children:(0,s.jsx)(eD.$_,{projectId:a,children:(0,s.jsx)(z.P,{baseSandboxUrl:v,refreshPreview:y,setDevServerEnabled:d,children:(0,s.jsx)(k,{children:(0,s.jsx)(rL,{projectId:a,baseSandboxUrl:v,iframeBaseUrl:j,devServerEnabled:c,refreshPreview:y,preview:b,iframeUrl:w,children:n})})})})})}},32825:function(e,t,r){"use strict";r.r(t),r.d(t,{DEFAULT_SIDEBAR_SIZE:function(){return o},PanelStoreProvider:function(){return d},useMinPanelSize:function(){return m},usePanelStore:function(){return u}});var s=r(57437),n=r(2265),a=r(59625);let l=e=>(0,a.Ue)(t=>({panelSizes:e||[o,100-o],updatePanelSizes:e=>t({panelSizes:e})}));var i=r(37545);let o=30,c=(0,n.createContext)(null);function d(e){let{initialPanelSizes:t,children:r}=e,a=(0,n.useRef)();return a.current||(a.current=l(t)),(0,s.jsx)(c.Provider,{value:a.current,children:r})}function u(e){let t=(0,n.useContext)(c);if(!t)throw Error("usePanelStore must be used within a PanelStoreProvider");return(0,a.oR)(t,e)}let m=()=>{let{width:e}=(0,i.Z)();return e?325/e*100:20}},19125:function(e,t,r){"use strict";var s=r(57437),n=r(92451),a=r(10407),l=r(2265),i=r(94508),o=r(62869);t.Z=l.memo(e=>{let{children:t,showScrollButtonsInitially:r=!1,className:c}=e,[d,u]=(0,l.useState)(!1),[m,h]=(0,l.useState)(r),[x,p]=(0,l.useState)(r),f=m||x,v=(0,l.useRef)(null),j=()=>{if(!v.current)return;let{scrollLeft:e,scrollWidth:t,clientWidth:r}=v.current;h(e>0),p(e<t-r)};return(0,l.useEffect)(()=>{u(!0),j()},[t]),(0,l.useEffect)(()=>(window.addEventListener("resize",j),()=>{window.removeEventListener("resize",j)}),[]),(0,s.jsxs)("div",{className:(0,i.cn)("relative flex max-w-full gap-1",c),children:[f&&(0,s.jsx)(o.z,{variant:"ghost",size:"sm",className:(0,i.cn)("absolute left-0 z-10 bg-background px-1 opacity-100 transition-opacity duration-200",{"!opacity-0":!d||!m,"pointer-events-none":!d||!m}),onClick:e=>{e.preventDefault(),v.current&&v.current.scrollTo({behavior:"smooth",left:v.current.scrollLeft-.8*v.current.clientWidth})},children:(0,s.jsx)(n.Z,{className:"self-center",size:"1.2em"})}),(0,s.jsx)("div",{ref:v,onScroll:j,className:"w-full overflow-x-auto whitespace-nowrap scrollbar-hide",children:t}),f&&(0,s.jsx)(o.z,{variant:"ghost",size:"sm",className:"px-1",disabled:!x,onClick:e=>{e.preventDefault(),v.current&&v.current.scrollTo({behavior:"smooth",left:v.current.scrollLeft+.8*v.current.clientWidth})},children:(0,s.jsx)(a.Z,{className:"self-center",size:"1.2em"})})]})})},85238:function(e,t,r){"use strict";r.d(t,{OX:function(){return p},Qz:function(){return d},dy:function(){return c},iI:function(){return f},sc:function(){return x},u6:function(){return v}});var s=r(57437),n=r(32489),a=r(2265),l=r(4216),i=r(62869),o=r(94508);let c=e=>{let{shouldScaleBackground:t=!1,...r}=e;return(0,s.jsx)(l.dy.Root,{shouldScaleBackground:t,...r})};c.displayName="Drawer";let d=l.dy.Trigger,u=l.dy.Portal,m=l.dy.Close,h=a.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(l.dy.Overlay,{ref:t,className:(0,o.cn)("fixed inset-0 z-[2000] bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n})});h.displayName=l.dy.Overlay.displayName;let x=a.forwardRef((e,t)=>{let{className:r,children:a,showCloseButton:c=!0,overlayProps:d,...x}=e;return(0,s.jsxs)(u,{children:[(0,s.jsx)(h,{...d}),(0,s.jsxs)(l.dy.Content,{ref:t,className:(0,o.cn)("fixed inset-y-0 right-0 z-[2001] flex h-dvh flex-nowrap border-l bg-popover",r),...x,children:[(0,s.jsx)("div",{className:"flex w-[80vw] flex-col gap-4 sm:w-96 sm:min-w-96",children:a}),c&&(0,s.jsx)("div",{className:"absolute right-4 top-6",children:(0,s.jsx)(m,{asChild:!0,children:(0,s.jsx)(i.z,{variant:"ghost",size:"icon-sm",children:(0,s.jsx)(n.Z,{size:"1.2em"})})})})]})]})});x.displayName="DrawerContent";let p=e=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,o.cn)("grid gap-1.5 text-left",t),...r})};p.displayName="DrawerHeader";let f=a.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(l.dy.Title,{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none",r),...n})});f.displayName=l.dy.Title.displayName;let v=a.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(l.dy.Description,{ref:t,className:(0,o.cn)("text-base text-muted-foreground",r),...n})});v.displayName=l.dy.Description.displayName},61563:function(e,t,r){"use strict";r.d(t,{G:function(){return d},t:function(){return c}});var s=r(57437),n=r(77921),a=r(2265),l=r(63611),i=r(94508);let o=a.createContext({size:"default",variant:"default"}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,children:c,...d}=e;return(0,s.jsx)(n.fC,{ref:t,className:(0,i.cn)("flex items-center justify-center gap-1",r),...d,children:(0,s.jsx)(o.Provider,{value:{variant:a,size:l},children:c})})});c.displayName=n.fC.displayName;let d=a.forwardRef((e,t)=>{let{className:r,children:c,variant:d,size:u,...m}=e,h=a.useContext(o);return(0,s.jsx)(n.ck,{ref:t,className:(0,i.cn)((0,l.E)({variant:h.variant||d,size:h.size||u}),r),...m,children:c})});d.displayName=n.ck.displayName},15345:function(e){e.exports={editor:"CodeEditor_editor__SnrZP"}}},function(e){e.O(0,[5754,4358,1413,8310,5878,5002,6401,6693,2972,7568,4240,8996,6999,5658,4438,6530,9291,3464,6008,6954,1229,6593,4797,1668,1961,237,2664,1248,6969,835,136,3204,4739,7050,9211,8729,991,2971,2577,1744],function(){return e(e.s=49383)}),_N_E=e.O()}]);